<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Andrew Rate" />

<meta name="date" content="2025-06-19" />

<title>Boxplots with Extras</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Sessions</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="about.html">For beginners</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Intro
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="intro.html">Intro</a>
    </li>
    <li>
      <a href="intro-GG.html">Intro+ggplot</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="plots.html">Plots-baseR</a>
    </li>
    <li>
      <a href="plots-GG.html">Plots-ggplot</a>
    </li>
    <li>
      <a href="boxplots-plus.html">Enhanced boxplots</a>
    </li>
    <li>
      <a href="depth-profiles.html">Depth profiles</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Compare
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="means.html">Compare means (parametric)</a>
    </li>
    <li>
      <a href="nonparam.html">Non-parametric comparisons</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Relate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="correl.html">Correlation</a>
    </li>
    <li>
      <a href="regression.html">Simple linear regression</a>
    </li>
    <li>
      <a href="reg-group.html">Grouped linear regression</a>
    </li>
    <li>
      <a href="reg-multi.html">Multiple linear regression</a>
    </li>
    <li>
      <a href="timeseries.html">Time series analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Maps
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="maps.html">Map data with tile backgrounds</a>
    </li>
    <li>
      <a href="spatial.html">Spatial statistics</a>
    </li>
    <li>
      <a href="spat-interp.html">Spatial interpolation</a>
    </li>
    <li>
      <a href="google-kml.html">Using Google Earth objects</a>
    </li>
    <li>
      <a href="georef-images.html">Using georeferenced images</a>
    </li>
    <li>
      <a href="shapefiles.html">Using shapefiles</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Multi
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="pca.html">Principal components analysis</a>
    </li>
    <li>
      <a href="vegan.html">Analysis of species presence-absence data</a>
    </li>
    <li>
      <a href="lda.html">Linear discriminant analysis</a>
    </li>
    <li>
      <a href="cluster.html">Cluster analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Util
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="distributions.html">Distribution checking</a>
    </li>
    <li>
      <a href="residuals.html">Regression residuals to identify contamination</a>
    </li>
    <li>
      <a href="hydrus1d.html">Hydrus-1D cheatsheet</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Reporting
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="report-resources.html">Resources for reporting</a>
    </li>
    <li>
      <a href="tablesPlus.html">Tables &amp; trigger value counts</a>
    </li>
    <li>
      <a href="maps-location-siteplan.html">Locality and Site Plan maps</a>
    </li>
    <li>
      <a href="One-page_R-Markdown.html">Brief essentials of R markdown</a>
    </li>
    <li>
      <a href="chunk-options.html">Custom output with R markdown chunk options</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://www.uwa.edu.au/schools/agriculture-and-environment">School of Agriculture and Environment</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<!DOCTYPE html>

<html>
<body>
<h3><img src="./images/2015-UWA-Full-Hor-CMYK.png" alt="UWA logo" align="right"><span style="color:#003087;">Material to support teaching in Environmental Science at The University of Western Australia</span></h3>
<h4><span style="color:#93721A;">Units ENVT3361, ENVT4461, and ENVT5503</span></h4></p>
</body>
</html>

<div id="header">



<h1 class="title toc-ignore">Boxplots with Extras</h1>
<h3 class="subtitle">Enhancing basic boxplots</h3>
<h4 class="author">Andrew Rate</h4>
<h4 class="date">2025-06-19</h4>

</div>


<p>First we load the data (an extension of the dataset described by Rate
&amp; McGrath, 2022) and the R packages we need:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>git <span class="ot">&lt;-</span> <span class="st">&quot;https://github.com/Ratey-AtUWA/Learn-R-web/raw/refs/heads/main/&quot;</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>afs1923 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(git,<span class="st">&quot;afs1923.csv&quot;</span>), <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(viridis)        <span class="co"># accessible colour palettes</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(rcompanion)     <span class="co"># utilities for pairwise comparisons</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(multcompView)   <span class="co"># utilities for pairwise comparisons</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(TeachingDemos)  <span class="co"># used only for the shadowtext() function</span></span></code></pre></div>
<div id="boxplots-with-clear-comparisons-and-intelligible-scales"
class="section level2">
<h2>Boxplots with clear comparisons and intelligible scales</h2>
<p>For exploratory data analysis it's common to draw a lot of boxplots.
The data we often explore in Environmental Science often includes
variables having positively skewed distributions. When drawing boxplots,
this means that some categories can be hard to visualise because they
have much lower concentrations than others, and the high values dominate
the plot (see Figure 1(a)).</p>
<p>We commonly deal with this by log transformation - Figure 1(b) shows
this, and the variables (and therefore boxplot boxes) now have more
symmetrical distributions which are all clearly visible on the plot. But
the <em>y</em> axis (concentration, in this case) doesn't show the
actual values.</p>
<p>Figure 1(c) shows the plot with a log-transformed <em>y</em> axis
scale, but this is not really satisfying either since the distribution
is still skewed but plotted on the compressed log-transformed
<em>y</em>-axis.</p>
<p>I think the best option, shown in Figure 1(d), is to plot the
log-transformed variable, but suppress the automatic axis and manually
add a <em>y</em>-axis with a transformed scale. It's a bit trickier, but
worth it. Now we can compare all the factor levels easily, yet still
have actual values on the axis (<em>e.g</em>. for comparison with
environmental guidelines).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="fl">1.5</span>,<span class="dv">1</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">2.4</span>,<span class="fl">0.2</span>,<span class="dv">0</span>), <span class="at">tcl=</span><span class="fl">0.25</span>, <span class="at">font.lab =</span> <span class="dv">2</span>,</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>    <span class="at">xpd =</span> F)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">with</span>(afs1923, <span class="fu">boxplot</span>(Zn <span class="sc">~</span> Zone, <span class="at">col=</span><span class="fu">viridis</span>(<span class="dv">12</span>, <span class="at">alpha=</span><span class="fl">0.5</span>), </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>                        <span class="at">las=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">cex =</span> <span class="fl">1.4</span>, <span class="at">cex.lab =</span> <span class="fl">1.4</span>))</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Sampling Zone&quot;</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;(a)&quot;</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">1.2</span>, <span class="at">adj =</span> <span class="fl">0.03</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Untransformed variable or axis&quot;</span>, <span class="dv">3</span>, <span class="fl">0.2</span>, <span class="at">font=</span><span class="dv">3</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">with</span>(afs1923, <span class="fu">boxplot</span>(<span class="fu">log10</span>(Zn) <span class="sc">~</span> Zone, <span class="at">col=</span><span class="fu">viridis</span>(<span class="dv">12</span>, <span class="at">alpha=</span><span class="fl">0.5</span>), </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>                        <span class="at">las=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">cex =</span> <span class="fl">1.4</span>, <span class="at">cex.lab =</span> <span class="fl">1.4</span>,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>                        <span class="at">ylab=</span><span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">paste</span>(log[<span class="dv">10</span>],<span class="st">&quot;(Zn)&quot;</span>)))))</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Sampling Zone&quot;</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;(b)&quot;</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">1.2</span>, <span class="at">adj =</span> <span class="fl">0.03</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Log-transformed variable&quot;</span>, <span class="dv">3</span>, <span class="fl">0.2</span>, <span class="at">font=</span><span class="dv">3</span>)</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="fu">with</span>(afs1923, <span class="fu">boxplot</span>(Zn <span class="sc">~</span> Zone, <span class="at">log =</span> <span class="st">&quot;y&quot;</span>, <span class="at">col=</span><span class="fu">viridis</span>(<span class="dv">12</span>, <span class="at">alpha=</span><span class="fl">0.5</span>), </span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>                        <span class="at">las=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">cex =</span> <span class="fl">1.4</span>, <span class="at">cex.lab =</span> <span class="fl">1.4</span>))</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Sampling Zone&quot;</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;(c)&quot;</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">1.2</span>, <span class="at">adj =</span> <span class="fl">0.03</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;Log-transformed variable &quot;</span>),<span class="fu">bold</span>(<span class="st">&quot;axis&quot;</span>))), </span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>      <span class="dv">3</span>, <span class="fl">0.2</span>, <span class="at">font=</span><span class="dv">3</span>)</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="fu">with</span>(afs1923, <span class="fu">boxplot</span>(<span class="fu">log10</span>(Zn) <span class="sc">~</span> Zone, <span class="at">col=</span><span class="fu">viridis</span>(<span class="dv">12</span>, <span class="at">alpha=</span><span class="fl">0.5</span>), </span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>                        <span class="at">las=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">cex =</span> <span class="fl">1.4</span>, <span class="at">cex.lab =</span> <span class="fl">1.4</span>, <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>                        <span class="at">ylab =</span> <span class="st">&quot;Zn&quot;</span>))</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>logtx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">2000</span>,<span class="dv">5000</span>,<span class="dv">10000</span>)</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">log10</span>(logtx), <span class="at">labels=</span>logtx, <span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Sampling Zone&quot;</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;(d)&quot;</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">1.2</span>, <span class="at">adj =</span> <span class="fl">0.03</span>, <span class="at">font =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue3&quot;</span>)</span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>], <span class="at">col=</span><span class="st">&quot;gold&quot;</span>, <span class="at">lwd=</span><span class="dv">9</span>)</span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Best option: log variable, custom axis&quot;</span>, <span class="dv">3</span>, <span class="fl">0.2</span>, <span class="at">font=</span><span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;blue3&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="boxplots-plus_files/figure-html/boxplots-2x2-1.png" alt="Figure 1: Four styles of boxplots based on the same data." width="672" />
<p class="caption">
Figure 1: Four styles of boxplots based on the same data.
</p>
</div>
<p> </p>
</div>
<div id="boxplots-with-added-means-or-observations"
class="section level2">
<h2>Boxplots with added means or observations</h2>
<p>Of course, this is not the only modification we can make with box
plots. A box plot is a good way to compare the spread of values between
different levels of a factor, and the thick line inside boxes shows how
the medians in each group vary. Sometimes we also like to look at where
the mean values are, especially if we have a parametric statistical test
to compare these means. It's not too difficult to superimpose the means
together with some measure of variability; the following example (Figure
2(a)) shows 95% confidence intervals around each group mean. We use the
<code>tapply()</code> function to make columns within a new data frame
which calculate confidence intervals and mean for a variable in groups
defined by a factor. The confidence are available from the output of the
<code>t.test()</code> function, so we use simple custom
<code>function</code> statements within <code>tapply()</code> to
generate just the confidence interval output.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">2.4</span>,<span class="fl">0.2</span>,<span class="dv">0</span>), <span class="at">tcl=</span><span class="fl">0.25</span>, <span class="at">font.lab =</span> <span class="dv">2</span>, <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># change data object, variable &amp; factor names to suit your data </span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>ci0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lo95=</span><span class="fu">with</span>(afs1923, </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                      <span class="fu">tapply</span>(<span class="fu">log10</span>(Zn), Zone, <span class="cf">function</span>(x){<span class="fu">t.test</span>(x)<span class="sc">$</span>conf.int[<span class="dv">1</span>]})),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                  <span class="at">mean=</span><span class="fu">with</span>(afs1923, </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                      <span class="fu">tapply</span>(<span class="fu">log10</span>(Zn), Zone, <span class="cf">function</span>(x){<span class="fu">mean</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>)})),</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                  <span class="at">hi95=</span><span class="fu">with</span>(afs1923, </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                      <span class="fu">tapply</span>(<span class="fu">log10</span>(Zn), Zone, <span class="cf">function</span>(x){<span class="fu">t.test</span>(x)<span class="sc">$</span>conf.int[<span class="dv">2</span>]})))</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">with</span>(afs1923, </span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>     <span class="fu">boxplot</span>(<span class="fu">log10</span>(Zn) <span class="sc">~</span> Zone, <span class="at">col=</span><span class="fu">viridis</span>(<span class="fu">nrow</span>(ci0), <span class="at">alpha=</span><span class="fl">0.5</span>),</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">&quot;Zn (mg/kg)&quot;</span>,</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>             <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>) </span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">tcl =</span> <span class="fl">0.4</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">NROW</span>(ci0)),</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">as.character</span>(<span class="fu">levels</span>(afs1923<span class="sc">$</span>Zone)))</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">log10</span>(logtx), <span class="at">labels=</span>logtx, <span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Sampling zone&quot;</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">3.5</span>, <span class="at">font =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co"># use arrow function to make background for [optional] error bars</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(ci0)), <span class="at">y0=</span>ci0[,<span class="dv">2</span>], <span class="at">y1=</span>ci0[,<span class="dv">1</span>], </span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">angle=</span><span class="dv">90</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">lwd=</span><span class="dv">6</span>) <span class="co"># optional</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(ci0)), <span class="at">y0=</span>ci0[,<span class="dv">2</span>], <span class="at">y1=</span>ci0[,<span class="dv">3</span>], </span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">angle=</span><span class="dv">90</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">lwd=</span><span class="dv">6</span>) <span class="co"># optional</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co"># draw lines to join points first, so the points overplot lines</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">NROW</span>(ci0)), ci0[,<span class="dv">2</span>], <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">&quot;c&quot;</span>)</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">NROW</span>(ci0)), ci0[,<span class="dv">2</span>], <span class="at">col=</span><span class="st">&quot;gray40&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">&quot;c&quot;</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co"># use arrow function to make actual [optional] error bars</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(ci0)), <span class="at">y0=</span>ci0[,<span class="dv">2</span>], <span class="at">y1=</span>ci0[,<span class="dv">1</span>], </span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;gray40&quot;</span>, <span class="at">angle=</span><span class="dv">90</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lend=</span><span class="dv">1</span>)</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(ci0)), <span class="at">y0=</span>ci0[,<span class="dv">2</span>], <span class="at">y1=</span>ci0[,<span class="dv">3</span>], </span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;gray40&quot;</span>, <span class="at">angle=</span><span class="dv">90</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lend=</span><span class="dv">1</span>)</span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co"># draw the points with white background for contrast</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">NROW</span>(ci0)), ci0[,<span class="dv">2</span>], <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">cex=</span><span class="fl">1.6</span>)</span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">NROW</span>(ci0)), ci0[,<span class="dv">2</span>], <span class="at">col=</span><span class="st">&quot;gray40&quot;</span>, </span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">16</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;(a)&quot;</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">1.2</span>, <span class="at">adj =</span> <span class="fl">0.03</span>)</span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(afs1923<span class="sc">$</span>Type)</span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="fu">palette</span>(<span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="fu">viridis</span>(nc, <span class="at">alpha=</span><span class="fl">0.5</span>),</span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>          <span class="fu">viridis</span>(<span class="fu">nlevels</span>(afs1923<span class="sc">$</span>Type), <span class="at">alpha=</span><span class="fl">0.75</span>),<span class="st">&quot;white&quot;</span>))</span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="fu">with</span>(afs1923, </span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>     <span class="fu">boxplot</span>(<span class="fu">log10</span>(Zn) <span class="sc">~</span> Type, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>nc)<span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">&quot;Zn (mg/kg)&quot;</span>,</span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a>             <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="at">las=</span><span class="dv">2</span>)) </span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">log10</span>(logtx), <span class="at">labels=</span>logtx, <span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Sample Type&quot;</span>, <span class="dv">1</span>, <span class="fl">4.5</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">log10</span>(<span class="dv">410</span>), <span class="at">col=</span><span class="st">&quot;dimgray&quot;</span>, <span class="at">lty=</span><span class="st">&quot;22&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a><span class="fu">with</span>(afs1923, <span class="fu">stripchart</span>(<span class="fu">log10</span>(Zn) <span class="sc">~</span> Type, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">vertical=</span><span class="cn">TRUE</span>, </span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a>                           <span class="at">method=</span><span class="st">&quot;jitter&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>nc)<span class="sc">+</span>(nc<span class="sc">+</span><span class="dv">1</span>)))</span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;(b)&quot;</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">1.2</span>, <span class="at">adj =</span> <span class="fl">0.97</span>)</span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, </span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a>       <span class="at">legend=</span><span class="st">&quot;Upper guideline value for</span><span class="sc">\n</span><span class="st">Zn in  sediment (410 mg/kg)&quot;</span>,</span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a>       <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">inset=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="st">&quot;22&quot;</span>, <span class="at">seg.len=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;dimgray&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="boxplots-plus_files/figure-html/boxplots-with-means-1.png" alt="Figure 2: Including additional information on boxplots; (a) mean and CI, (b) individual observations, with the sediment GV-high concentration for Zn (410 mg/kg; Water Quality Australia 2024)." width="864" />
<p class="caption">
Figure 2: Including additional information on boxplots; (a) mean and CI,
(b) individual observations, with the sediment GV-high concentration for
Zn (410 mg/kg; Water Quality Australia 2024).
</p>
</div>
<p> </p>
<p>Figure 2(b) shows the actual observations, and an environmental
threshold for Zn. Showing the individual values is probably more useful
when there are fewer observations, in which case the boxplots themselves
may not represent the distributions well. In addition, including the
individual values with an environmental threshold means we can
[approximately] count the number of samples exceeding the threshold.</p>
</div>
<div id="boxplots-with-pairwise-comparisons" class="section level2">
<h2>Boxplots with pairwise comparisons</h2>
<p>We often use a boxplot to visualise a statistical comparison of means
(including non-parametric comparisons such as a Kruskal-Wallis test). If
the overall test shows a significant effect (<em>i.e</em>. p ≤ 0.05), we
follow up with a <em>post-hoc</em> pairwise comparison such as a
pairwise t-test or Wilcoxon test. The significant pairwise differences
are conveniently and concisely summarised in the “compact letter
display”, in which factor levels having no letters in common have
significant pairwise differences.</p>
<p>The compact letters are often presented as superscripts or suffixes
in a table of means, but they can also be included on box plots, as
shown in the code below.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">2.4</span>,<span class="fl">0.2</span>,<span class="dv">0</span>), <span class="at">tcl=</span><span class="fl">0.25</span>, <span class="at">font.lab =</span> <span class="dv">2</span>, </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co"># 1. compact letters at mean values for each level</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">with</span>(afs1923, <span class="fu">boxplot</span>(<span class="fu">log10</span>(Zn) <span class="sc">~</span> Type, <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,             <span class="co"># suppress axes</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                    <span class="at">col=</span><span class="fu">viridis</span>(<span class="fu">nlevels</span>(Type), <span class="at">alp=</span><span class="fl">0.4</span>, <span class="at">end=</span><span class="fl">0.9</span>),</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                    <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Zn (mg/kg)&quot;</span>))</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Sample Type&quot;</span>, <span class="dv">1</span>, <span class="fl">4.5</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">font=</span><span class="dv">2</span>, <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co"># manual log-transf axis</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">log10</span>(logtx), <span class="at">labels=</span>logtx, <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.6</span>,<span class="fl">0.2</span>,<span class="dv">0</span>), </span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>     <span class="at">tcl=</span><span class="fl">0.25</span>)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>meansZn <span class="ot">&lt;-</span> <span class="fu">with</span>(afs1923, </span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>                <span class="fu">tapply</span>(<span class="fu">log10</span>(Zn), Type, <span class="cf">function</span>(x){<span class="fu">mean</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>)}))</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>pwZn <span class="ot">&lt;-</span> <span class="fu">with</span>(afs1923, <span class="fu">pairwise.wilcox.test</span>(Zn, Type))</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>mclZn <span class="ot">&lt;-</span> <span class="fu">multcompLetters</span>(<span class="fu">fullPTable</span>(pwZn<span class="sc">$</span>p.value)) </span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co"># plot compact letters at mean values</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="fu">shadowtext</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), meansZn, <span class="at">labels=</span>mclZn<span class="sc">$</span>Letters, <span class="at">col=</span><span class="dv">1</span>, <span class="at">bg=</span><span class="dv">10</span>, <span class="at">r=</span><span class="fl">0.2</span>)</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co"># 2. compact letters near axis</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>rgZn <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">log10</span>(afs1923<span class="sc">$</span>Zn), <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="fu">with</span>(afs1923, <span class="fu">boxplot</span>(<span class="fu">log10</span>(Zn) <span class="sc">~</span> Type, <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,             <span class="co"># suppress axes</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>                    <span class="at">col=</span><span class="fu">viridis</span>(<span class="fu">nlevels</span>(Type), <span class="at">alp=</span><span class="fl">0.4</span>, <span class="at">end=</span><span class="fl">0.9</span>),</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>                    <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Zn (mg/kg)&quot;</span>,</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>                    <span class="at">ylim=</span><span class="fu">c</span>(rgZn[<span class="dv">1</span>]<span class="sc">-</span><span class="fl">0.7</span>,rgZn[<span class="dv">2</span>])))</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Sample Type&quot;</span>, <span class="dv">1</span>, <span class="fl">4.5</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">font=</span><span class="dv">2</span>, <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co"># manual log-transf axis</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">log10</span>(logtx[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)]), <span class="at">labels=</span>logtx[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)], <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.6</span>,<span class="fl">0.2</span>,<span class="dv">0</span>), </span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>     <span class="at">tcl=</span><span class="fl">0.25</span>)</span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>pwZn <span class="ot">&lt;-</span> <span class="fu">with</span>(afs1923, <span class="fu">pairwise.wilcox.test</span>(Zn, Type))</span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>mclZn <span class="ot">&lt;-</span> <span class="fu">multcompLetters</span>(<span class="fu">fullPTable</span>(pwZn<span class="sc">$</span>p.value)) </span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co"># plot compact letters at mean values</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>pu <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">&quot;usr&quot;</span>)</span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="fu">rep</span>(pu[<span class="dv">3</span>]<span class="sc">+</span><span class="fl">0.06</span><span class="sc">*</span>(pu[<span class="dv">4</span>]<span class="sc">-</span>pu[<span class="dv">3</span>]),<span class="dv">4</span>), </span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a>           <span class="at">labels=</span>mclZn<span class="sc">$</span>Letters, <span class="at">family=</span><span class="st">&quot;serif&quot;</span>, <span class="at">font=</span><span class="dv">3</span>)</span></code></pre></div>
<div class="figure">
<img src="boxplots-plus_files/figure-html/boxplot-compact-letters-1.png" alt="Figure 3: Including pairwise compact letters on boxplots; (a) compact letters at mean values; (b) compact letters at selected coordinates. Categories having no letters in common have significant pairwise differences (p ≤ 0.05)." width="864" />
<p class="caption">
Figure 3: Including pairwise compact letters on boxplots; (a) compact
letters at mean values; (b) compact letters at selected coordinates.
Categories having no letters in common have significant pairwise
differences (p ≤ 0.05).
</p>
</div>
<p> </p>
<p>Figure 3 shows two options for presenting compact letters on a
boxplot. You can choose the one you like best, or adapt the code to make
your own!</p>
<p> </p>
</div>
<div id="references-and-r-packages" class="section level2">
<h2>References and R Packages</h2>
<p>Garnier S, Ross N, Rudis R, Camargo AP, Sciaini M, Scherer C (2021).
<em>Rvision - Colorblind-Friendly Color Maps for R</em>. R package
version 0.6.2. <a href="https://sjmgarnier.github.io/viridis/"
target="_blank">https://sjmgarnier.github.io/viridis/</a>
(<code>viridis</code> package).</p>
<p>Graves S, Piepho H, Dorai-Raj LSwhfS (2024).
<code>multcompView</code>: <em>Visualizations of Paired
Comparisons</em>. R package version 0.1-10, <a
href="https://CRAN.R-project.org/package=multcompView"
target="_blank">https://CRAN.R-project.org/package=multcompView</a>.</p>
<p>Mangiafico, Salvatore S. (2024). <code>rcompanion</code>:
<em>Functions to Support Extension Education Program Evaluation</em>.
version 2.4.36. Rutgers Cooperative Extension. New Brunswick, New
Jersey. <a href="https://CRAN.R-project.org/package=rcompanion"
target="_blank">https://CRAN.R-project.org/package=rcompanion</a></p>
<p>Rate, A. W., &amp; McGrath, G. S. (2022). Data for assessment of
sediment, soil, and water quality at Ashfield Flats Reserve, Western
Australia. <em>Data in Brief</em>, <strong>41</strong>, 107970. <a
href="https://doi.org/10.1016/j.dib.2022.107970"
target="_blank">https://doi.org/10.1016/j.dib.2022.107970</a></p>
<p>Snow G (2024). <code>TeachingDemos</code>: <em>Demonstrations for
Teaching and Learning</em>. R package version 2.13, <a
href="https://CRAN.R-project.org/package=TeachingDemos"
target="_blank">https://CRAN.R-project.org/package=TeachingDemos</a></p>
<p>Water Quality Australia. (2024). <em>Toxicant default guideline
values for sediment quality.</em> Department of Climate Change, Energy,
the Environment and Water, Government of Australia. Retrieved 2024-04-11
from <a
href="https://www.waterquality.gov.au/anz-guidelines/guideline-values/default/sediment-quality-toxicants"
target="_blank">https://www.waterquality.gov.au/anz-guidelines/guideline-values/default/sediment-quality-toxicants</a></p>
<p> </p>
</div>

<!DOCTYPE html>

<html>
<body>
<hr style="height: 2px; background-color: #003087;" />
<p><span style="font-size:10pt"><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><strong>CC-BY-SA</strong></a> • All content by <a href="https://github.com/Ratey-AtUWA" target="_blank">Ratey-AtUWA</a>. My <a href="https://www.uwa.edu.au/schools/agriculture-and-environment" target="_blank">employer</a> does not necessarily know about or endorse the content of this website.</span><br>
<span style="font-size:9pt">Created with <a href="https://bookdown.org/yihui/rmarkdown/" target="_blank"><span style="font-family: monospace;">rmarkdown</span></a> in <a href="https://posit.co/download/rstudio-desktop/" target="_blank"><span class="fa fa-registered"></span> RStudio</a>. Currently using the free <a href="https://bootswatch.com/yeti/" target="_blank"><span style="font-family: monospace;">yeti</span> theme from Bootswatch</a>.</span></p>
</body>
</html>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
