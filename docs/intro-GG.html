<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2024-05-23" />

<title>RStudio introduction with ggplot</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/tabwid-1.1.0/tabwid.css" rel="stylesheet" />
<link href="site_libs/tabwid-1.1.0/scrool.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Sessions</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="about.html">For beginners</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Intro
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="intro.html">Intro</a>
    </li>
    <li>
      <a href="intro-GG.html">Intro+ggplot</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="plots.html">Plots-baseR</a>
    </li>
    <li>
      <a href="plots-GG.html">Plots-ggplot</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Maps
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="maps.html">Map data with tile backgrounds</a>
    </li>
    <li>
      <a href="spatial.html">spatial stats</a>
    </li>
    <li>
      <a href="spat-interp.html">spatial interpolation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    EDA
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="tables.html">Tables + trigger value counts</a>
    </li>
    <li>
      <a href="distributions.html">Distribution checking</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">RStudio introduction with ggplot</h1>
<h4 class="date">2024-05-23</h4>

</div>


<style type="text/css">
  body{
  font-size: 12pt;
}
</style>
<p><img src="intro-GG_files/figure-html/banner%20hide%20code-1.png" width="100%" style="display: block; margin: auto 0 auto auto;" /></p>
<p>This guide gets you started with reading data into <strong>R</strong>
(R Core Team, 2022) from a file, including checking that the data have
been read in correctly. We will always be using <strong>R</strong> in
the RStudio environment (Posit Software, 2022).</p>
<p style="text-align: center;">
<span style="font-size: 15pt;">If you need or would like a more basic
introduction to <strong>R</strong>, you could first read our<br> <a
href="about.html" target="&quot;_blank">Guide to R and RStudio for
absolute beginners</a>.</span>
</p>
<div id="reading-the-data" class="section level2">
<h2>Reading the data</h2>
<p>We use the <code>read.csv()</code> function ‚Äì we will mostly supply
data to you as <code>.csv</code> files. Sometimes you need to download
these into your working directory to use them, and sometimes you can
read them directly from a web URL (<em>e.g</em>. <a
href="https://github.com/Ratey-AtUWA/learningR/raw/main/afs19.csv"
target="_blank"><code>https://github.com/.../afs19.csv</code></a>).</p>
<p>With the type of dataset we usually use, there are columns containing
categorical information, which <strong>R</strong> calls
<code>factors</code>. These are typically stored as text or character
information, <em>i.e</em>. character strings, or just
<code>strings</code>. <strong>R</strong> identifies <code>factors</code>
in a particular way so the categories are recognised, so we need to use
the <code>stringsAsFactors = TRUE</code> argument in the
<code>read.csv()</code> function.</p>
<p>The result of the <code>read.csv()</code> function is a <strong>data
frame</strong> object stored in the <strong>R</strong> environment. We
need a data frame, since it is a data structure in <strong>R</strong>
which allows having columns of different classes (<em>e.g</em>. integer,
numeric, factor, date, logical, <em>etc</em>.) in the same object (each
column contains just one class of data, though).</p>
<p>Objects we create in an <strong>R</strong> session like data frames
are only stored while we have our <strong>R</strong> session active, and
disappear when we close <strong>R</strong>. Fortunately we can save our
whole environment by clicking the üíæ icon on the <span
style="background-color:#404040; color:white;">¬†Environment¬†</span> tab,
or by running the <code>save.image()</code> function. Either of these
saving methods will create a file with extension <code>.RData</code>
which we can then load in later <strong>R</strong> sessions using the
<code>load()</code> function, or clicking the üìÅ icon in the <span
style="background-color:#404040; color:white;">¬†Environment¬†</span> tab
in RStudio.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>git <span class="ot">&lt;-</span> <span class="st">&quot;https://github.com/Ratey-AtUWA/Learn-R/raw/main/&quot;</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>hubbard <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="fu">paste0</span>(git,<span class="st">&quot;hubbard.csv&quot;</span>), <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># ... and do a quick check</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">is.data.frame</span>(hubbard) <span class="co"># check that it worked; if so, the result should be TRUE</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>These data are from the <a
href="https://hubbardbrook.org/experimental-watersheds-research-sites/"
target="_blank">Hubbard Brook Experimental Forest</a> near Woodstock in
New Hampshire, USA (Figure 1).</p>
<div class="figure">
<img src="intro-GG_files/figure-html/hubbard-pix-1.png" alt="Figure 1: Location of the Hubbard Brook Experimental Forest in New Hampshire, USA. The data used in this workshop were generated at this site." width="1305.6" />
<p class="caption">
Figure 1: Location of the Hubbard Brook Experimental Forest in New
Hampshire, USA. The data used in this workshop were generated at this
site.
</p>
</div>
<p>
¬†
</p>
</div>
<div id="first-proper-check---summarise-some-of-the-data"
class="section level2">
<h2>First proper check - summarise some of the data</h2>
<p>We can use the <code>summary()</code> function to make a quick check
of our data, to make sure the file has read correctly (this may not
happen if the file is improperly formatted, <em>etc</em>.).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">summary</span>(hubbard[,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]) <span class="co"># just the first 9 columns to save space!</span></span></code></pre></div>
<pre><code>##       PLOT       Rel.To.Brook    Transect   UTM_EASTING      UTM_NORTHING           PH         MOISTURE.pct   
##  Min.   :  1.0   North:135    E278000:44   Min.   :276000   Min.   :4866300   Min.   :2.510   Min.   : 0.510  
##  1st Qu.:126.8   South:125    E277000:43   1st Qu.:277000   1st Qu.:4867800   1st Qu.:4.168   1st Qu.: 3.068  
##  Median :254.5                E280000:37   Median :279000   Median :4869000   Median :4.350   Median : 4.131  
##  Mean   :249.2                E276000:35   Mean   :278996   Mean   :4868769   Mean   :4.322   Mean   : 5.367  
##  3rd Qu.:392.2                E279000:34   3rd Qu.:281000   3rd Qu.:4869700   3rd Qu.:4.503   3rd Qu.: 6.324  
##  Max.   :460.0                E282000:25   Max.   :283000   Max.   :4871100   Max.   :4.870   Max.   :26.262  
##                               (Other):42                                                                      
##      OM.pct             Cd        
##  Min.   : 2.240   Min.   :0.0980  
##  1st Qu.: 9.188   1st Qu.:0.3070  
##  Median :11.162   Median :0.6350  
##  Mean   :12.009   Mean   :0.7426  
##  3rd Qu.:13.582   3rd Qu.:1.1310  
##  Max.   :50.177   Max.   :1.8890  
##                   NA&#39;s   :167</code></pre>
<p>
¬†
</p>
<p>The <code>summary()</code> function creates a little table for each
column - note that these little tables do not all look the same.
<code>Integer</code> or <code>numeric</code> columns get a numeric
summary with minimum, mean <em>etc.</em>, and sometime the number of
missing (<code>NA</code>) values. Categorical (<code>Factor</code>)
columns show the number of samples (rows) in each category (unless there
are too many categories). These summaries are useful to check if there
are zero or negative values in columns, how many missing observations
there might be, and if the data have been read correctly into R.</p>
<p>
¬†
</p>
<div style="border: 2px solid #039; padding: 8px;">
<p><strong>Note</strong>: You would usually check the <strong>whole data
frame</strong>, without restricting rows or columns, by running
<code>summary(hubbard)</code>. We could also:</p>
<ul>
<li>summarise all variables, but only the first 10 rows by running
<code>summary(hubbard[1:10,])</code> (we also call rows 'observations'
which often represent separate field samples);</li>
<li>summarise a defined range of both rows and columns, <em>e.g</em>.
<code>summary(hubbard[1:20,6:10])</code>, which would summarise only the
first 20 rows of columns 6 to 10.</li>
</ul>
</div>
<p>
¬†
</p>
</div>
<div id="final-checks-of-the-data-frame" class="section level2">
<h2>Final checks of the data frame</h2>
<p>Usually we would not restrict the output as done below with
<code>[,1:15]</code>. We only do it here so we're not bored with pages
of similar-looking output. You should look at structure for the whole
data frame using <code>str(hubbard)</code> (or substitute
<code>hubbard</code> for whatever your data object is called). The whole
<code>hubbard</code> data frame has 62 variables (<em>i.e</em>.
columns), not 15.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">str</span>(hubbard[,<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>]) <span class="co"># &#39;str&#39; gives the structure of an object</span></span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    260 obs. of  15 variables:
##  $ PLOT        : int  1 2 3 5 6 7 8 9 10 11 ...
##  $ Rel.To.Brook: Factor w/ 2 levels &quot;North&quot;,&quot;South&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Transect    : Factor w/ 8 levels &quot;E276000&quot;,&quot;E277000&quot;,..: 5 5 5 5 5 5 5 5 5 5 ...
##  $ UTM_EASTING : int  280000 280000 280000 280000 280000 280000 280000 280000 280000 280000 ...
##  $ UTM_NORTHING: int  4868400 4868500 4868700 4869000 4869100 4869300 4869400 4869600 4869700 4869900 ...
##  $ PH          : num  4.29 4.66 4.23 4.15 4.49 4.79 4.11 4.52 4.51 4.43 ...
##  $ MOISTURE.pct: num  4.74 7.47 5.55 3.77 4.82 ...
##  $ OM.pct      : num  12.2 10.46 14.88 9.14 12.01 ...
##  $ Cd          : num  0.498 0.207 1.359 0.913 0.099 ...
##  $ Cu          : num  22.1 27.1 18.6 7 17 ...
##  $ Ni          : num  12.25 20.5 14.43 8.72 10.62 ...
##  $ Cr          : num  21.1 28.2 19.6 21.3 22.8 ...
##  $ Co          : num  14.4 17 13.1 11.1 11.4 ...
##  $ Zn          : num  47.6 63.1 47.5 18.2 31.9 ...
##  $ Mn          : num  490 453 578 261 335 ...</code></pre>
<p>We can see that some columns are integer (<code>int</code>) values
(<em>e.g</em>. PLOT, UTM_EASTING), some columns contain
<code>Factor</code> values <em>i.e</em>. in fixed categories
(<em>e.g</em>. Rel.To.Brook, Transect), and some columns are numeric
(<code>num</code>) (<em>e.g</em>. PH, OM.pct, Ni). Applying the
<code>str()</code> function to a data object is <strong>always</strong>
a good idea, to check that the data have read correctly into R. [NOTE
that other variable types are possible such as character
<code>chr</code>, date (<code>Date</code> or <code>POSIXct</code>),
<code>logical</code>, <em>etc</em>.]</p>
<hr style="height: 1px; background-color: #5560A4;" />
<blockquote>
<p>"Data is like garbage. You'd better know what you are going to do
with it before you collect it."</p>
<p>‚Äî Mark Twain</p>
</blockquote>
<hr style="height: 1px; background-color: #5560A4;" />
<div
style="border: 2px solid #039; background-color:#ffb; padding: 8px;">
<p>The following section describes how to make graphs and plots in
base-<strong>R</strong> and in the <code>ggplot2</code> package. <a
href="intro.html">Go to this page</a> if you want base-R only, without
the <code>ggplot2</code> material.</p>
</div>
</div>
<div id="base-r-plotting-x-y-plot-using-plot" class="section level1">
<h1>Base R plotting: x-y plot using <code>plot()</code></h1>
<p>We can use either <code>plot(x, y, ...)</code> OR
<code>plot(y ~ x, ...)</code> <br> In R the <code>~</code> symbol means
'as a function of', so <code>~</code> indicates a formula.</p>
<p>In R we need to tell the program which 'object' our variables are in.
We've just made a Data Frame (a type of data object) called
<code>hubbard</code>.</p>
<p>The following 3 styles of code do exactly the same thing:</p>
<ol style="list-style-type: decimal">
<li><u>Specifying the data frame using <code>with()</code> syntax -- (we
recommend this one!)</u></li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">with</span>(hubbard,</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>     <span class="fu">plot</span>(EXCH_Al <span class="sc">~</span> PH)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>)</span></code></pre></div>
<p>...which can just be written on a single line:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">with</span>(hubbard, <span class="fu">plot</span>(EXCH_Al <span class="sc">~</span> PH))</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/with-plot-1.png" alt="Figure 2: Plot of exchangeable Al vs. pH using with() to specify the data frame." width="336" />
<p class="caption">
Figure 2: Plot of exchangeable Al vs. pH using with() to specify the
data frame.
</p>
</div>
<p>
¬†
</p>
<ol start="2" style="list-style-type: decimal">
<li><u>Specifying the data frame using the dollar-sign operator</u></li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(hubbard<span class="sc">$</span>EXCH_Al <span class="sc">~</span> hubbard<span class="sc">$</span>PH) <span class="co"># look at axis titles!</span></span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/dollar-plot-1.png" alt="Figure 3: Plot of exchangeable Al vs. pH using dollar-sign syntax to specify the data frame. Notice the axis titles!" width="336" />
<p class="caption">
Figure 3: Plot of exchangeable Al vs. pH using dollar-sign syntax to
specify the data frame. Notice the axis titles!
</p>
</div>
<p>
¬†
</p>
<ol start="3" style="list-style-type: decimal">
<li><u>Specifying the data frame using</u> <code>attach()</code>
<u>and</u> <code>detach()</code> <u><strong>(not
recommended)</strong></u></li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">attach</span>(hubbard)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">plot</span>(EXCH_Al <span class="sc">~</span> PH)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">detach</span>(hubbard)</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/plot-attach-1.png" alt="Figure 4: Plot of exchangeable Al vs. pH using `attach()` to specify the data frame." width="336" />
<p class="caption">
Figure 4: Plot of exchangeable Al vs. pH using <code>attach()</code> to
specify the data frame.
</p>
</div>
<p>
¬†
</p>
<p>Without changing any of the (numerous) options or parameters in the
<code>plot()</code> function, the base-R plot is not very attractive
(<em>e.g</em>. axis titles!).</p>
<p>We can also change the overall plot appearance by using the function
<code>par()</code> before plotting; <code>par()</code> sets graphics
<strong>par</strong>ameters. Let's try some variations:</p>
<div id="alternative-plot-using-ggplot-wickham-2016"
class="section level3">
<h3>Alternative plot using <code>ggplot</code> (Wickham, 2016)</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>hubbard, <span class="fu">aes</span>(<span class="at">x=</span> PH, <span class="at">y =</span> EXCH_Al)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/gg-AlEx-pH-1.png" alt="Figure 5: Basic plot of exchangeable Al vs. pH using the `ggplot2` R package." width="336" />
<p class="caption">
Figure 5: Basic plot of exchangeable Al vs. pH using the
<code>ggplot2</code> R package.
</p>
</div>
<p>
¬†
</p>
<p>Plots made using <code>ggplot2</code> such as Figure 5 set
<code>par()</code>options automatically, and come with a default table
style, or <code>theme</code>.</p>
</div>
<div id="setting-some-overall-graphics-parameters-using-par"
class="section level3">
<h3>Setting some overall graphics parameters using
<code>par()</code></h3>
<ul>
<li><code>mar=</code> sets <strong>mar</strong>gins in 'lines' units:
<code>c(bottom,left,top,right)</code> <em>e.g</em>.
<code>c(4,4,3,1)</code></li>
<li><code>mgp=</code> sets distance of text from axes:
<code>c(titles, tickLabels, ticks)</code></li>
<li><code>font.lab=</code> sets font style for axis titles:
2=<strong>bold</strong>, 3=<em>italic</em>, <em>etc</em>.<br>
<ul>
<li>and within the <code>plot()</code> function itself,
<code>xlab=</code> and <code>ylab=</code> set axis titles</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.6</span>,<span class="dv">0</span>), <span class="at">font.lab=</span><span class="dv">2</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># We&#39;ll also include some better axis title text using xlab, ylab</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">with</span>(hubbard,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>     <span class="fu">plot</span>(EXCH_Al <span class="sc">~</span> PH, </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Soil pH&quot;</span>, </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Exchangeable Al (centimoles/kg)&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>     )</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/plot-with-options-1.png" alt="Figure 6: Plot of exchangeable Al vs. pH improved by changing graphics parameters and including custom axis titles." width="384" />
<p class="caption">
Figure 6: Plot of exchangeable Al vs. pH improved by changing graphics
parameters and including custom axis titles.
</p>
</div>
<p>
¬†
</p>
<p>This is starting to look a lot better!</p>
<p>We can still add more information to the graph; for example, by
making use of the factors (categories) in the dataset. We also need to
learn these graphics parameters:</p>
<ul>
<li><p><code>col =</code> plotting colour(s) - it's easiest to use words
like "red", "darkblue" and so on<br> see <a
href="https://lms.uwa.edu.au/bbcswebdav/xid-47078256_1"
target="_blank">this R colour chart</a>, or just run the R function
<code>colors()</code> for a list of all 657 names!</p></li>
<li><p><code>pch =</code> plot character(s) - numbers from 0 to 24 (run
<code>help(points)</code> or see
<a href="https://bookdown.org/ndphillips/YaRrr/scatterplot-plot.html#symbol-types-pch" target="_blank">this
page from YaRrr</a>).</p></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.6</span>,<span class="dv">0</span>), <span class="at">font.lab=</span><span class="dv">2</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">with</span>(hubbard,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>     <span class="fu">plot</span>(EXCH_Al <span class="sc">~</span> PH, <span class="at">xlab=</span><span class="st">&quot;Soil pH&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>          <span class="at">ylab=</span><span class="st">&quot;Exchangeable Al (centimoles/kg)&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>          <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">16</span>)[Rel.To.Brook], </span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>          <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;darkred&quot;</span>)[Rel.To.Brook])</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>     )</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/plot-by-groups-1.png" alt="Figure 7: Plot of exchangeable Al vs. pH with custom graphics parameters and axis titles, improved by separating points by a Factor." width="384" />
<p class="caption">
Figure 7: Plot of exchangeable Al vs. pH with custom graphics parameters
and axis titles, improved by separating points by a Factor.
</p>
</div>
<p>
¬†
</p>
<p>The parameter <code>pch=c(1,16)[Rel.To.Brook]</code> separates the
points by the information in the Factor column
<code>Rel.To.Brook</code>, shown inside <code>[ ]</code>. This column is
a 2-level factor, so can be one of two categories (North or South), and
so we need a vector with two numbers in it (<code>pch=c(1,16)</code>).
The code for specifying colour is very similar, except our vector has 2
colour names in it.</p>
<p>There is still one thing missing; a <strong>graph legend</strong>. We
can add one using the <code>legend()</code> function. We will use the
following options:</p>
<ul>
<li><code>"topleft"</code> position of legend -- run
<code>help(legend)</code> for options, or we can use x-y
coordinates</li>
<li><code>legend =</code> a vector of names identifying the plot symbols
- we have used the categories in the factor 'Rel.To.Brook',
<code>levels(hubbard$Rel.To.Brook)</code>, but we could have used
<code>legend=c("North","South")</code> instead</li>
<li><code>pch =</code> plot symbols - should be exactly the same vector
as in the plot function</li>
<li><code>col =</code> plot colours - should be exactly the same vector
as in the plot function</li>
<li><code>title =</code> a title for the legend - optional</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.6</span>,<span class="dv">0</span>), <span class="at">font.lab=</span><span class="dv">2</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">with</span>(hubbard,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>       <span class="fu">plot</span>(EXCH_Al <span class="sc">~</span> PH, <span class="at">xlab=</span><span class="st">&quot;Soil pH&quot;</span>, </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>            <span class="at">ylab=</span><span class="st">&quot;Exchangeable Al (centimoles/kg)&quot;</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>            <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">16</span>)[Rel.To.Brook], </span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>            <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;darkred&quot;</span>)[Rel.To.Brook])</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>       )</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">levels</span>(hubbard<span class="sc">$</span>Rel.To.Brook), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">16</span>), </span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;darkred&quot;</span>), <span class="at">title=</span><span class="st">&quot;Location&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/plot-add-legend-1.png" alt="Figure 8: Plot of exchangeable Al vs. pH by sample location, with custom graphics parameters and axis titles, and a legend to explain the plot symbols." width="384" />
<p class="caption">
Figure 8: Plot of exchangeable Al vs. pH by sample location, with custom
graphics parameters and axis titles, and a legend to explain the plot
symbols.
</p>
</div>
<hr style="height: 3px; background-color: #5560A4;" />
</div>
<div id="alternative-plot-using-ggplot" class="section level3">
<h3>Alternative plot using <code>ggplot</code></h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>hubbard, </span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span> PH, <span class="at">y =</span> EXCH_Al, <span class="at">color=</span>Rel.To.Brook, <span class="at">shape=</span>Rel.To.Brook)) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">2.5</span>) <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Exchangeable Al (cmolc/kg)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Soil pH&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/gg-AlEx-pH-2-1.png" alt="Figure 9: Plot of exchangeable Al vs. pH in the Hubbard Brook soil data using the `ggplot2` R package showing points categorized by the factor `Rel.To.Brook`, and using a non-default plot theme." width="460.8" />
<p class="caption">
Figure 9: Plot of exchangeable Al vs. pH in the Hubbard Brook soil data
using the <code>ggplot2</code> R package showing points categorized by
the factor <code>Rel.To.Brook</code>, and using a non-default plot
theme.
</p>
</div>
<p>
¬†
</p>
<p>In the <code>ggplot2</code> example in Figure 9 we have used the
<code>aes()</code> option to specify different colours and symbols
depending on the value of a factor (<code>Rel.To.Brook</code>). A legend
is created automatically. We have also used a different theme option
(<code>theme_bw()</code>), which is arguably more appropriate than the
default which has a grey plot background.</p>
</div>
</div>
<div id="alternative-to-base-r-plot-scatterplot-from-the-car-package"
class="section level1">
<h1>Alternative to base-R plot: <code>scatterplot()</code> (from the
<code>car</code> package)</h1>
<p>The R package <code>car</code> (Companion to Applied Regression) has
many useful additional functions that extend the capability of
<strong>R</strong>. The next two examples produce nearly the same plot
as in the previous examples, using the <code>scatterplot()</code>
function in the <code>car</code> package.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># load required package(s)</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co"># par() used to set overall plot appearance using options within </span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># par(), e.g.</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#     mar sets plot margins, mgp sets distance of axis title and </span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#     tick labels from axis</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">2.2</span>,<span class="fl">0.7</span>,<span class="fl">0.0</span>))</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co"># draw scatterplot with customised options </span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co"># remember pch sets plot character (symbol); </span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co"># we will also use the parameter cex which sets symbol sizes and</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="fu">scatterplot</span>(EXCH_Al <span class="sc">~</span> PH, <span class="at">data=</span>hubbard, <span class="at">smooth=</span><span class="cn">FALSE</span>, </span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>            <span class="at">legend =</span> <span class="fu">c</span>(<span class="at">coords=</span><span class="st">&quot;topleft&quot;</span>), </span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>            <span class="at">cex=</span><span class="fl">1.5</span>, <span class="at">cex.lab=</span><span class="fl">1.5</span>, <span class="at">cex.axis=</span><span class="fl">1.2</span>)</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/car-sp-1-1.png" alt="Figure 10: Plot of exchangeable Al vs. pH made using the car::scatterplot() function." width="336" />
<p class="caption">
Figure 10: Plot of exchangeable Al vs. pH made using the
car::scatterplot() function.
</p>
</div>
<p>
¬†
</p>
<p>Note that we get some additional graph features by default:</p>
<ol style="list-style-type: decimal">
<li>boxplots for each variable in the plot margins ‚Äì these are useful
for evaluating the distribution of our variables and any extreme
values</li>
<li>a linear regression line showing the trend of the relationship (it's
possible to add this in base R plots, too)</li>
<li>grid lines in the plot area (also available in base R)</li>
</ol>
<p>We can turn all of these features off if we want - run
<code>help(scatterplot)</code> in the RStudio Console, and look under
<strong>Arguments</strong> and <strong>Details</strong>.</p>
<p>Also, we separately specify the dataset to be used as a function
argument, <em>i.e</em>., <code>data=hubbard</code>.</p>
<div id="scatterplot-car-with-groups-hubbard-brook-soil-data"
class="section level3">
<h3>Scatterplot (<code>car</code>) with groups, Hubbard Brook soil
data</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># &#39;require()&#39; loads package(s) if they haven&#39;t already been loaded</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">require</span>(car)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co"># adjust overall plot appearance using options within par()</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co"># mar sets plot margins, mgp sets distance of axis title and tick </span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#   labels from axis</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">2.2</span>,<span class="fl">0.7</span>,<span class="fl">0.0</span>))</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co"># create custom palette with nice colours :)</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co"># this lets us specify colours using numbers - try it!</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="fu">palette</span>(<span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red3&quot;</span>,<span class="st">&quot;blue3&quot;</span>,<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;sienna&quot;</span>))</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co"># draw scatterplot with points grouped by a factor (Rel.To.Brook) </span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="fu">scatterplot</span>(EXCH_Al <span class="sc">~</span> PH <span class="sc">|</span> Rel.To.Brook, <span class="at">data=</span>hubbard, <span class="at">smooth=</span><span class="cn">FALSE</span>,</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>            <span class="at">legend =</span> <span class="fu">c</span>(<span class="at">coords=</span><span class="st">&quot;topleft&quot;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>), </span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>            <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.axis=</span><span class="fl">1.0</span>)</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/car-sp-2-1.png" alt="Figure 11: Plot of exchangeable Al vs. pH with points grouped by location, made using the car::scatterplot() function." width="336" />
<p class="caption">
Figure 11: Plot of exchangeable Al vs. pH with points grouped by
location, made using the car::scatterplot() function.
</p>
</div>
<p>
¬†
</p>
<p>The <code>scatterplot()</code> function creates a legend
automatically if we plot by factor groupings (note the different way
that the legend position is specified within the
<code>scatterplot()</code> function). This is pretty similar to the base
R plot above (we can also customise the axis titles in
<code>scatterplot()</code>, using <code>xlab=</code> and
<code>ylab=</code> as before).</p>
<hr style="height: 3px; background-color: #5560A4;" />
</div>
</div>
<div id="other-types-of-data-presentation-plot-types-and-tables"
class="section level1">
<h1>Other types of data presentation: Plot types and Tables</h1>
<p>We'll give you some starting code chunks, and the output from them.
You can then use the help in RStudio to try to customise the plots
according to the suggestions below each plot!</p>
<div id="histograms" class="section level2">
<h2>Histograms</h2>
<p>Histograms are an essential staple of statistical plots, because we
always need to know something about the distribution of our variable(s).
Histograms are a good visual way to assess the shape of a variable's
distribution, whether it's symmetrical and bell-shaped
(<em>normal</em>), left- or right-skewed, bimodal (two 'peaks') or even
multimodal. As with any check of a distribution, the 'shape' will be
clearer if we have more observations.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">with</span>(hubbard, <span class="fu">hist</span>(MOISTURE.pct))</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/basic-hist-1.png" alt="Figure 12: Histogram of percent soil moisture content at Hubbard Brook." width="336" />
<p class="caption">
Figure 12: Histogram of percent soil moisture content at Hubbard Brook.
</p>
</div>
<p>
¬†
</p>
<div id="histogram-in-ggplot" class="section level3">
<h3>Histogram in <code>ggplot</code></h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> hubbard, <span class="fu">aes</span>(<span class="at">x=</span>MOISTURE.pct)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;lightgray&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/gg-hist-1.png" alt="Figure 13: Histogram of water content (%) in the Hubbard Brook soil data using `ggplot2`, and using a non-default ggplot theme." width="460.8" />
<p class="caption">
Figure 13: Histogram of water content (%) in the Hubbard Brook soil data
using <code>ggplot2</code>, and using a non-default ggplot theme.
</p>
</div>
<p>
¬†
</p>
<p>For histograms, try the following:</p>
<ul>
<li>add suitable axis labels (titles)</li>
<li>make bars a different colour (all the same)</li>
<li>change the number of cells (bars) on the histogram to give wider or
narrower intervals</li>
<li>log<sub>10</sub>-transform the x-axis (horizontal axis)</li>
<li>remove the title above the graph (this information would usually go
in a caption)<br> ...and so on.</li>
</ul>
</div>
</div>
<div id="box-plots" class="section level2">
<h2>Box plots</h2>
<p>Box plots also give us some information about a variable's
distribution, but one of their great strengths is in comparing values of
a variable between different groups in our data.</p>
<p><em>Tukey box plots</em> implemented by <strong>R</strong> have 5 key
values; from least to greatest these are:</p>
<ol style="list-style-type: decimal">
<li>the <strong>lower whisker</strong>, which is the greatest of the
minimum or the <em>lower hinge</em> ‚àí 1.5 √ó IQR<sup>a</sup></li>
<li>the <strong>lower hinge</strong>, which is the lower quartile
(25<sup>th</sup> percentile)</li>
<li>the <strong>median</strong> (<em>i.e</em>. the 50<sup>th</sup>
percentile)</li>
<li>the <strong>upper hinge</strong>, which is the upper quartile
(75<sup>th</sup> percentile)</li>
<li>the <strong>upper whisker</strong>, , which is the least of the
maximum or the <em>upper hinge</em> + 1.5 √ó IQR</li>
</ol>
<p>Any points less than the lower whisker, or greater than the upper
whisker, are plotted separately and represent <strong>potential
outliers</strong>.</p>
<p><sup>a</sup><strong>IQR</strong> is the interquartile range between
the upper and lower quartiles (25<sup>th</sup> and 75<sup>th</sup>
percentiles)</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">boxplot</span>(MOISTURE.pct <span class="sc">~</span> Rel.To.Brook, <span class="at">data=</span>hubbard)</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/basic-boxplot-1.png" alt="Figure 14: Box plot of percent soil moisture content at Hubbard Brook. Only default `boxplot()` arguments have been used (except for the annotations explaining the boxplot features)." width="528" />
<p class="caption">
Figure 14: Box plot of percent soil moisture content at Hubbard Brook.
Only default <code>boxplot()</code> arguments have been used (except for
the annotations explaining the boxplot features).
</p>
</div>
<p>
¬†
</p>
<p>For box plots, try the following:</p>
<ul>
<li>include informative axis labels (titles)</li>
<li>plotting boxes separated by categories in a Factor</li>
<li>make boxes a different colour (all the same, and all
different!)</li>
<li>add notches to boxes representing approximate 95% confidence
intervals around the median</li>
<li>give the (vertical) y-axis a log<sub>10</sub> scale<br>...and so
on.</li>
</ul>
<div id="boxplot-in-ggplot" class="section level3">
<h3>Boxplot in <code>ggplot</code></h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> hubbard, <span class="fu">aes</span>(<span class="at">x=</span>Rel.To.Brook, <span class="at">y=</span>MOISTURE.pct)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="st">&quot;lightgray&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/gg-boxplot-1.png" alt="Figure 15: Boxplot of water content (%) in the Hubbard Brook soil data using `ggplot2`, and using a non-default ggplot theme." width="460.8" />
<p class="caption">
Figure 15: Boxplot of water content (%) in the Hubbard Brook soil data
using <code>ggplot2</code>, and using a non-default ggplot theme.
</p>
</div>
<p>
¬†
</p>
</div>
</div>
<div id="strip-charts" class="section level2">
<h2>Strip Charts</h2>
<p>Strip charts, or one-dimensional scatter plots, can be a useful
companion (or alternative) to box plots, especially when we don't have
many observations of a variable.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">stripchart</span>(hubbard<span class="sc">$</span>OM.pct)</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/basic-mfrow-1.png" alt="Figure 16: Soil organic matter content (%) at Hubbard Brook: as a one-dimensional scatterplot (`stripchart()`)." width="480" />
<p class="caption">
Figure 16: Soil organic matter content (%) at Hubbard Brook: as a
one-dimensional scatterplot (<code>stripchart()</code>).
</p>
</div>
<p>
¬†
</p>
<div id="stripchart-in-ggplot" class="section level3">
<h3>Stripchart in <code>ggplot</code></h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> hubbard, <span class="fu">aes</span>(<span class="at">x=</span>MOISTURE.pct, <span class="at">y=</span><span class="st">&quot;&quot;</span>)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure">
<img src="intro-GG_files/figure-html/gg-stripchart-1.png" alt="Figure 17: Strip chart of water content (%) in the Hubbard Brook soil data using `ggplot2`, and using a non-default ggplot theme." width="460.8" />
<p class="caption">
Figure 17: Strip chart of water content (%) in the Hubbard Brook soil
data using <code>ggplot2</code>, and using a non-default ggplot theme.
</p>
</div>
<p>
¬†
</p>
<p>For stripcharts, try the following:</p>
<ul>
<li>add suitable axis labels (titles), in bold font;</li>
<li>make symbols a different shape ¬± colour (all the same, and all
different!);</li>
<li>make the strip chart vertical instead of horizontal;</li>
<li>apply some 'jitter' (noise) to the symbols so that overlapping
points are easier to see;</li>
<li>log<sub>10</sub>-transform the numerical axis, so that overlapping
points are easier to see;</li>
<li>rotate the y-axis titles 90¬∞ clockwise (make sure the left margin is
wide enough!);</li>
<li>remove the titles above the graphs (this information would usually
go in caption/s)<br>...and so on.</li>
</ul>
<hr style="height: 1px; background-color: #5560A4;" />
<blockquote>
<p>"With data collection, 'the sooner the better' is always the best
answer."</p>
<p>‚Äî <a href="https://en.wikipedia.org/wiki/Marissa_Mayer"
target="_blank">Marissa Mayer</a></p>
</blockquote>
<hr style="height: 1px; background-color: #5560A4;" />
</div>
</div>
<div id="tables" class="section level2">
<h2>Tables</h2>
<p>There are a few ways to make useful tables in R to summarise your
data. Here are a couple of examples.</p>
<div id="using-the-tapply-function-in-base-r" class="section level3">
<h3>Using the <code>tapply()</code> function in base R</h3>
<p>We can use the <code>tapply()</code> function to make very simple
tables:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># use the cat() [conCATenate] function to make a Table heading </span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">#     (\n is a line break)</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;One-way table of means</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="fu">with</span>(hubbard, <span class="fu">tapply</span>(<span class="at">X =</span> EXCH_Ni, <span class="at">INDEX=</span>Transect, </span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>       <span class="at">FUN=</span>mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Two-way table of means</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="fu">with</span>(hubbard, <span class="fu">tapply</span>(<span class="at">X =</span> EXCH_Ni, </span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>       <span class="at">INDEX=</span><span class="fu">list</span>(Transect,Rel.To.Brook), </span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>       <span class="at">FUN=</span>mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## One-way table of means
##     E276000     E277000     E278000     E279000     E280000     E281000     E282000     E283000 
## 0.002588815 0.002136418 0.002827809 0.002813563 0.002528296 0.002262386 0.002221885 0.002957922 
## 
## Two-way table of means
##               North       South
## E276000 0.002652212 0.002559759
## E277000 0.002154745 0.002117219
## E278000 0.003133112 0.002360874
## E279000 0.002733461 0.002927993
## E280000 0.002176569 0.002861511
## E281000 0.002537732 0.001962009
## E282000 0.002219457 0.002224313
## E283000 0.003542597 0.002039146</code></pre>
<p>
¬†
</p>
<p>For <code>tapply()</code> tables, try the following:</p>
<ul>
<li>we have used the <code>mean</code> function (<code>FUN=mean</code>)
‚Äì try another function to get minima, maxima, standard deviations,
<em>etc</em>.</li>
<li>try copying the output to Word or Excel and using this to make a
table in that software<br> ...and so on.</li>
</ul>
</div>
<div id="using-the-numsummary-function-in-the-rcmdrmisc-r-package"
class="section level3">
<h3>Using the <code>numSummary()</code> function in the 'RcmdrMisc' R
package</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">require</span>(RcmdrMisc)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co"># use the cat() [conCATenate] function to make a Table heading </span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co">#   (\n is a line break)</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Summary statistics for EXCH_Ni</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="fu">numSummary</span>(hubbard<span class="sc">$</span>EXCH_Ni)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Summary statistics for EXCH_Ni grouped by Rel.To.Brook</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="fu">numSummary</span>(hubbard<span class="sc">$</span>EXCH_Ni, <span class="at">groups=</span>hubbard<span class="sc">$</span>Rel.To.Brook)</span></code></pre></div>
<pre><code>## Summary statistics for EXCH_Ni
##         mean          sd         IQR         0%         25%         50%         75%       100%   n NA
##  0.002536502 0.001382344 0.001126141 0.00070457 0.001829135 0.002246775 0.002955276 0.01784169 257  3
## 
## Summary statistics for EXCH_Ni grouped by Rel.To.Brook
##              mean          sd         IQR          0%         25%         50%         75%        100% data:n
## North 0.002635924 0.001605190 0.001114533 0.001120626 0.001933342 0.002277016 0.003047875 0.017841689    132
## South 0.002431513 0.001096042 0.001170948 0.000704570 0.001719421 0.002174767 0.002890369 0.008483806    125
##       data:NA
## North       3
## South       0</code></pre>
<p>For <code>numSummary()</code> tables, try the following:</p>
<ul>
<li>generating summary tables for more than one variable at a time</li>
<li>generating summary tables with fewer statistical parameters
(<em>e.g</em>. omit IQR) or more statistical parameters (<em>e.g</em>.
include skewness)<br> (use R Studio Help!)</li>
<li>try copying the output to Word or Excel and using this to make a
table in that software<br>...and so on.</li>
</ul>
</div>
<div id="tables-using-print-on-a-data-frame" class="section level3">
<h3>Tables using <code>print()</code> on a data frame</h3>
<p>Data frames are themselves tables, and if they already contain the
type of summary we need, we can just use the <code>print()</code>
function to get output. Let's do something [slightly] fancy (see if you
can figure out what is going on here¬π):</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>output <span class="ot">&lt;-</span> </span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  <span class="fu">numSummary</span>(hubbard[,<span class="fu">c</span>(<span class="st">&quot;PH&quot;</span>,<span class="st">&quot;MOISTURE.pct&quot;</span>,<span class="st">&quot;OM.pct&quot;</span>,<span class="st">&quot;Al.pct&quot;</span>,<span class="st">&quot;Ca.pct&quot;</span>,<span class="st">&quot;Fe.pct&quot;</span>)],</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>             <span class="at">statistics =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;sd&quot;</span>,<span class="st">&quot;quantiles&quot;</span>), <span class="at">quantiles=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>))</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>mytable <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">cbind</span>(output<span class="sc">$</span>table,output<span class="sc">$</span>NAs))</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="fu">row.names</span>(mytable) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Std.dev.&quot;</span>,<span class="st">&quot;Min.&quot;</span>,<span class="st">&quot;Median&quot;</span>,<span class="st">&quot;Max.&quot;</span>,<span class="st">&quot;Missing&quot;</span>)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co"># here&#39;s where we get the output</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="fu">print</span>(mytable, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="fu">write.table</span>(mytable,<span class="st">&quot;clipboard&quot;</span>,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">The table has now been copied to the clipboard, so you can paste it into Excel!</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##             PH MOISTURE.pct OM.pct Al.pct Ca.pct Fe.pct
## Mean     4.322         5.37  12.01  1.641  0.208  3.163
## Std.dev. 0.293         3.83   5.17  1.478  0.214  1.112
## Min.     2.510         0.51   2.24  0.155  0.002  0.497
## Median   4.350         4.13  11.16  0.970  0.139  3.168
## Max.     4.870        26.26  50.18  7.132  1.107  7.709
## Missing  0.000         0.00   0.00 60.000 62.000 60.000
## 
## The table has now been copied to the clipboard, so you can paste it into Excel!</code></pre>
<p>¬πHints: we have made two data frame objects, one from the output of
<code>numSummary()</code>; <code>t()</code> is the transpose function;
there are also some other useful functions which might be new to you
like: <code>row.names()</code>, <code>cbind()</code>,
<code>print()</code>, <code>write.table()</code> . . .</p>
<p>If you want to take this further, we can start making really nice
Tables for reports with various <strong>R</strong> packages. I use the
<code>flextable</code> package (Gohel &amp; Skintzos, 2022) and
sometimes the <code>kable()</code> function from the <code>knitr</code>
package. Here's an example (Table 1) using <code>flextable</code> and
the table object <code>mytable</code> made above:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="fu">flextable</span>(<span class="fu">data.frame</span>(<span class="at">Statistic=</span><span class="fu">row.names</span>(mytable),<span class="fu">signif</span>(mytable,<span class="dv">3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">bold=</span><span class="cn">TRUE</span>, <span class="at">part=</span><span class="st">&quot;header&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="at">caption=</span><span class="st">&quot;Table 1: A table created by the `flextable` R package. Many more table formatting, text formatting, and number formatting options are available in this package.&quot;</span>)</span></code></pre></div>
<template id="3e9db43b-cc00-4512-b4ac-9ba1f36977cd"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-8402d554{}.cl-83ebd624{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-83ebd638{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-83f5dbd8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-83f5dbf6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-83f60cde{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-83f60cf2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-83f60cfc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-83f60d06{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-83f60d10{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-83f60d1a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-83dee298{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}</style><table class='cl-8402d554'><caption><span class="cl-83dee298">Table 1: A table created by the `flextable` R package. Many more table formatting, text formatting, and number formatting options are available in this package.</span></caption><thead><tr style="overflow-wrap:break-word;"><td class="cl-83f60cde"><p class="cl-83f5dbd8"><span class="cl-83ebd624">Statistic</span></p></td><td class="cl-83f60cf2"><p class="cl-83f5dbf6"><span class="cl-83ebd624">PH</span></p></td><td class="cl-83f60cf2"><p class="cl-83f5dbf6"><span class="cl-83ebd624">MOISTURE.pct</span></p></td><td class="cl-83f60cf2"><p class="cl-83f5dbf6"><span class="cl-83ebd624">OM.pct</span></p></td><td class="cl-83f60cf2"><p class="cl-83f5dbf6"><span class="cl-83ebd624">Al.pct</span></p></td><td class="cl-83f60cf2"><p class="cl-83f5dbf6"><span class="cl-83ebd624">Ca.pct</span></p></td><td class="cl-83f60cf2"><p class="cl-83f5dbf6"><span class="cl-83ebd624">Fe.pct</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-83f60cfc"><p class="cl-83f5dbd8"><span class="cl-83ebd638">Mean</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">4.320</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">5.37</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">12.00</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">1.640</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.208</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">3.160</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-83f60cfc"><p class="cl-83f5dbd8"><span class="cl-83ebd638">Std.dev.</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.293</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">3.83</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">5.17</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">1.480</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.214</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">1.110</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-83f60cfc"><p class="cl-83f5dbd8"><span class="cl-83ebd638">Min.</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">2.510</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.51</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">2.24</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.155</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.002</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.497</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-83f60cfc"><p class="cl-83f5dbd8"><span class="cl-83ebd638">Median</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">4.350</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">4.13</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">11.20</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.970</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.139</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">3.170</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-83f60cfc"><p class="cl-83f5dbd8"><span class="cl-83ebd638">Max.</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">4.870</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">26.30</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">50.20</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">7.130</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">1.110</span></p></td><td class="cl-83f60d06"><p class="cl-83f5dbf6"><span class="cl-83ebd638">7.710</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-83f60d10"><p class="cl-83f5dbd8"><span class="cl-83ebd638">Missing</span></p></td><td class="cl-83f60d1a"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.000</span></p></td><td class="cl-83f60d1a"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.00</span></p></td><td class="cl-83f60d1a"><p class="cl-83f5dbf6"><span class="cl-83ebd638">0.00</span></p></td><td class="cl-83f60d1a"><p class="cl-83f5dbf6"><span class="cl-83ebd638">60.000</span></p></td><td class="cl-83f60d1a"><p class="cl-83f5dbf6"><span class="cl-83ebd638">62.000</span></p></td><td class="cl-83f60d1a"><p class="cl-83f5dbf6"><span class="cl-83ebd638">60.000</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="2e0f96ba-1d75-4fdd-b870-95c7d1560491"></div>
<script>
var dest = document.getElementById("2e0f96ba-1d75-4fdd-b870-95c7d1560491");
var template = document.getElementById("3e9db43b-cc00-4512-b4ac-9ba1f36977cd");
var caption = template.content.querySelector("caption");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>
¬†
</p>
<div style="border: 2px solid #039; padding: 8px;">
<p><span style="font-size: 14pt;">The following two excellent websites
can extend your basic knowledge of using <strong>R</strong> and
RStudio:</span></p>
<ul>
<li><p>A great free resource for <strong>R</strong> beginners is <a
href="https://intro2r.com/">An Introduction to R</a> by Alex Douglas,
Deon Roos, Francesca Mancini, Ana Couto &amp; David Lusseau.</p></li>
<li><p><a href="https://bookdown.org/chesterismay/rbasics/"
target="_blank">Getting used to R, RStudio, and R Markdown</a> is an
awesome (and free) eBook by Chester Ismay which is super-helpful if you
want to start using <strong>R Markdown</strong> for reproducible coding
and reporting.</p></li>
</ul>
</div>
<hr style="height: 2px; background-color: #5560A4;" />
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Fox J (2022). <em>RcmdrMisc: R Commander Miscellaneous
Functions</em>. R package version 2.7-2, <a
href="https://CRAN.R-project.org/package=RcmdrMisc"
target="_blank">https://CRAN.R-project.org/package=RcmdrMisc</a>.</p>
<p>Fox J, Weisberg S (2019). <em>An {R} Companion to Applied Regression,
Third Edition</em>. Thousand Oaks CA: Sage. <a
href="https://socialsciences.mcmaster.ca/jfox/Books/Companion/"
target="_blank">https://socialsciences.mcmaster.ca/jfox/Books/Companion/</a>
(<strong>car</strong> package).</p>
<p>Gohel D, Skintzos P (2022). <em>flextable: Functions for Tabular
Reporting</em>. R package version 0.8.1, <a
href="https://CRAN.R-project.org/package=flextable"
target="_blank">https://CRAN.R-project.org/package=flextable</a>.</p>
<p>Posit Software (2022) <em>RStudio 2022.12.0+353 "Elsbeth Geranium"
Release</em>. <a href="https://posit.co/products/open-source/rstudio/"
target="_blank">https://posit.co/products/open-source/rstudio/</a>.</p>
<p>R Core Team (2022). R: A language and environment for statistical
computing. R Foundation for Statistical Computing, Vienna, Austria. URL
<a href="https://www.R-project.org/"
target="_blank">https://www.R-project.org/</a>.</p>
<p>Wickham, H. <em>ggplot2: Elegant Graphics for Data Analysis</em>.
Springer-Verlag New York, 2016. <a href="https://ggplot2.tidyverse.org"
target="_blank">https://ggplot2.tidyverse.org</a>.</p>
<p>
¬†
</p>
</div>
</div>

<!DOCTYPE html>

<html>
<body>
<hr style="height: 2px; background-color: #003087;" />
<p><span style="font-size:9pt"><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><strong>CC-BY-SA</strong></a> ‚Ä¢ All content by <a href="https://github.com/Ratey-AtUWA" target="_blank">Ratey-AtUWA</a>. My <a href="https://www.uwa.edu.au/schools/agriculture-and-environment" target="_blank">employer</a> does not necessarily know about or endorse the content of this website.</span><br>
<span style="font-size:9pt">Created with <span style="font-family: monospace;">rmarkdown</span> in <a href="https://www.rstudio.com/" target="_blank"><span class="fa fa-registered"></span> RStudio</a>.</span></p>
</body>
</html>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
