<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Andrew Rate" />

<meta name="date" content="2024-06-19" />

<title>Statistical Relationships</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/tabwid-1.1.0/tabwid.css" rel="stylesheet" />
<link href="site_libs/tabwid-1.1.0/scrool.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Sessions</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="about.html">For beginners</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Intro

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="intro.html">Intro</a>
    </li>
    <li>
      <a href="intro-GG.html">Intro+ggplot</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Plots

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="plots.html">Plots-baseR</a>
    </li>
    <li>
      <a href="plots-GG.html">Plots-ggplot</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Compare

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="means.html">Compare means (parametric)</a>
    </li>
    <li>
      <a href="nonparam.html">Non-parametric comparisons</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Relate

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="correl.html">Correlation</a>
    </li>
    <li>
      <a href="regression.html">Simple linear regression</a>
    </li>
    <li>
      <a href="reg-group.html">Grouped linear regression</a>
    </li>
    <li>
      <a href="reg-multi.html">Multiple linear regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Maps

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="maps.html">Map data with tile backgrounds</a>
    </li>
    <li>
      <a href="spatial.html">Spatial statistics</a>
    </li>
    <li>
      <a href="spat-interp.html">Spatial interpolation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Multi

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="pca.html">Principal components analysis</a>
    </li>
    <li>
      <a href="vegan.html">Analysis of species presence-absence data</a>
    </li>
    <li>
      <a href="lda.html">Linear discriminant analysis</a>
    </li>
    <li>
      <a href="cluster.html">Cluster analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Util

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="tables.html">Tables &amp; trigger value counts</a>
    </li>
    <li>
      <a href="distributions.html">Distribution checking</a>
    </li>
    <li>
      <a href="residuals.html">Regression residuals to identify contamination</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://www.uwa.edu.au/schools/agriculture-and-environment">UWA School of Agriculture and Environment</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<!DOCTYPE html>

<html>
<body>
<h3><img src="./images/2015-UWA-Full-Hor-CMYK.png" alt="UWA logo" align="right"><span style="color:#003087;">Material to support teaching in Environmental Science<br />at The University of Western Australia</span></h3>
<h4><span style="color:#93721A;">Units ENVT3361, ENVT4461, and ENVT5503</span></h4></p>
</body>
</html>

<div id="header">



<h1 class="title toc-ignore">Statistical Relationships</h1>
<h3 class="subtitle">Simple linear regression</h3>
<h4 class="author">Andrew Rate</h4>
<h4 class="date">2024-06-19</h4>

</div>


<style type="text/css">
  body{
  font-size: 12pt;
}
</style>
<div style="border: 2px solid #039; padding: 8px;">
<p style="text-align:center; font-size:12pt;">
<em>Relationships pages</em>: <a href="correl.html"
style="color:#04b;">Correlations</a> | <a href="regression.html"
style="color:#04b;">Simple linear regression</a> | <a
href="reg-group.html" style="color:#04b;">Grouped linear regression</a>
| <a href="reg-multi.html" style="color:#04b;">Multiple linear
regression</a>
</p>
</div>
<p> </p>
<div
style="border: 2px solid #039; background-color:#e8e8e8; padding: 8px;">
<p>Using the R code file provided and the <code>afs1923</code>
dataset:</p>
<ul>
<li>Run a simple regression model,</li>
<li>Assess whether or not a regression model meets the statistical
assumptions,</li>
<li>Try the additional suggestions at the end of the R code file,
and</li>
<li>Make sure you understand the concepts for all the statistical
methods you use, and can interpret all the output!</li>
</ul>
<p>If you need to install packages like <code>car</code>,
<code>lmtest</code>, and <code>effects</code> this should be done first,
either:</p>
<ol style="list-style-type: lower-alpha">
<li>from the RStudio packages tab;</li>
<li>running some code like the example below for each package you need
to install.<br>     <code>install.packages("psych")</code></li>
</ol>
<p><span
style="font-size: 12pt;"><iframe width="360" height="240" src="https://echo360.net.au/media/f444fd3e-9d67-468b-aeb2-c2b27ca26c5e/public?autoplay=false&amp;automute=false" title="E3361+Correl+Regr.mp4" allowfullscreen="allowfullscreen" webkitallowfullscreen="webkitallowfullscreen" mozallowfullscreen="mozallowfullscreen"></iframe></span></p>
<p>
<a href="https://raw.githubusercontent.com/Ratey-AtUWA/Learn-R/main/afs1923.csv"><span
style="font-size: 12pt;">💾 The afs1923 dataset in csv (comma-separated)
format</span></a>
</p>
<p>
<a href="https://lms.uwa.edu.au/bbcswebdav/pid-3088955-dt-content-rid-40243114_1/xid-40243114_1"><span
style="font-size: 12pt;">🔣 R code file for this workshop
session</span></a>
</p>
</div>
<p>Regression and correlation are often considered together, but they
are not the same thing. <strong>Correlation</strong> measures the
strength and direction of a relationship between two variables.
<strong>Regression</strong> is a model in which the variance in one
variable (the "<em>dependent</em>" variable) is explained by one, or a
combination of, <em>predictor</em> variables (also called "independent"
variables). We will cover only <strong>linear regression</strong>, where
the dependent variable is a linear function of the predictor
variable(s).</p>
<p>Our usual first step is to read the data, and change anything we need
to:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>git <span class="ot">&lt;-</span> <span class="st">&quot;https://github.com/Ratey-AtUWA/Learn-R/raw/main/&quot;</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>afs1923 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(git,<span class="st">&quot;afs1923.csv&quot;</span>), <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>afs1923<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="fu">factor</span>(afs1923<span class="sc">$</span>Type, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Drain_Sed&quot;</span>,<span class="st">&quot;Lake_Sed&quot;</span>,<span class="st">&quot;Saltmarsh&quot;</span>,<span class="st">&quot;Other&quot;</span>))</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>afs1923<span class="sc">$</span>Type2 <span class="ot">&lt;-</span> </span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="fu">factor</span>(afs1923<span class="sc">$</span>Type2, </span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Drain_Sed&quot;</span>,<span class="st">&quot;Lake_Sed&quot;</span>,<span class="st">&quot;Saltmarsh W&quot;</span>,<span class="st">&quot;Saltmarsh E&quot;</span>,<span class="st">&quot;Other&quot;</span>))</span></code></pre></div>
<p>Using the <code>afs1923</code> dataset, we will make a <strong>simple
linear regression</strong> model predicting chromium from aluminium.</p>
<p>Before we investigate a regression model, we inspect the scatterplot
(Figure 1).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">oma=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">tcl=</span><span class="fl">0.2</span>,</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>    <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.1</span>, <span class="at">cex.axis=</span><span class="fl">1.</span>, <span class="at">lend=</span><span class="st">&quot;square&quot;</span>, <span class="at">ljoin=</span><span class="st">&quot;mitre&quot;</span>, <span class="at">font.lab=</span><span class="dv">2</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">with</span>(afs1923, <span class="fu">plot</span>(Cr <span class="sc">~</span> Al, <span class="at">data =</span> afs1923, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">&quot;Al (mg/kg)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cr (mg/kg)&quot;</span>))</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col=</span><span class="st">&quot;grey&quot;</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>afs1923<span class="sc">$</span>Al.log <span class="ot">&lt;-</span> <span class="fu">log10</span>(afs1923<span class="sc">$</span>Al)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>afs1923<span class="sc">$</span>Cr.log <span class="ot">&lt;-</span> <span class="fu">log10</span>(afs1923<span class="sc">$</span>Cr)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">with</span>(afs1923, <span class="fu">points</span>(Cr <span class="sc">~</span> Al, <span class="at">data =</span> afs1923, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>)[Type2], </span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>            <span class="at">bg =</span> <span class="fu">plasma</span>(<span class="fu">nlevels</span>(afs1923<span class="sc">$</span>Type2))[Type2],</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">&quot;Al (mg/kg)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cr (mg/kg)&quot;</span>))</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(Cr <span class="sc">~</span> Al, <span class="at">data=</span>afs1923), <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;#80808080&quot;</span>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend=</span><span class="fu">levels</span>(afs1923<span class="sc">$</span>Type2), <span class="at">box.col=</span><span class="st">&quot;grey&quot;</span>, <span class="at">cex=</span><span class="fl">0.85</span>,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>       <span class="at">inset=</span><span class="fl">0.01</span>, <span class="at">pt.bg=</span><span class="fu">plasma</span>(<span class="fu">nlevels</span>(afs1923<span class="sc">$</span>Type2)), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>),</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>       <span class="at">title=</span><span class="fu">expression</span>(<span class="fu">bold</span>(<span class="st">&quot;Sample type&quot;</span>)))</span></code></pre></div>
<div class="figure">
<img src="regression_files/figure-html/Cr-Al-scatterplot-1.png" alt="Figure 1: Scatterplot showing relationship between Cr and Al at Ashfield Flats Reserve in 2019-2023. Observations and regression lines are separated by sample Type." width="480" />
<p class="caption">
Figure 1: Scatterplot showing relationship between Cr and Al at Ashfield
Flats Reserve in 2019-2023. Observations and regression lines are
separated by sample Type.
</p>
</div>
<p>
 
</p>
<p><em>We show the Sample type to confirm that all types follow
approximately the same relationship</em> – remember <a
href="correl.html">checking relationships for correlation in a previous
session</a>?</p>
<p>Creating a simple regression model is straightforward in
<strong>R</strong>. We use the <code>lm()</code> function to create a
linear model object (give it a memorable name), with the model defined
by a formula using the tilde <code>~</code> operator which most often
means ‘depends on%rsquo;. In our example we have:</p>
<p>-<code>Cr&amp;nbsp;~&amp;nbsp;Al</code> which, in context, means
<code>Cr</code> as a linear function of <code>Al</code> - The
<em>dependent variable</em> is <code>Cr</code> which is conventionally
plotted on the <span class="math inline">\(y\)</span>-axis - The
<em>independent variable</em> or <em>predictor</em> is <code>Al</code>
which is conventionally plotted on the <span
class="math inline">\(x\)</span>-axis</p>
<p>We then run a <code>summary()</code> of the model object, as this
gives the most informative output:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>lmCrAlsimple <span class="ot">&lt;-</span> <span class="fu">lm</span>(Cr <span class="sc">~</span> Al, <span class="at">data =</span> afs1923)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">summary</span>(lmCrAlsimple)</span></code></pre></div>
<pre><code>##
## Call:
## lm(formula = Cr ~ Al, data = afs1923)
##
## Residuals:
##     Min      1Q  Median      3Q     Max
## -40.751  -5.349  -0.251   5.774  52.250
##
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) 7.672e+00  1.284e+00   5.976 5.89e-09 ***
## Al          1.359e-03  3.829e-05  35.480  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##
## Residual standard error: 9.428 on 333 degrees of freedom
## Multiple R-squared:  0.7908, Adjusted R-squared:  0.7902
## F-statistic:  1259 on 1 and 333 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The output from a linear model summary in R is quite extensive:</p>
<ol style="list-style-type: decimal">
<li><code>Call</code>: gives the model we specified (for checking)</li>
<li><code>Residuals</code>: some summary statistics for the difference
of the model from the measured values – these differences are called the
<strong>residuals</strong></li>
<li><code>Coefficients</code>: a table showing the parameters of the
line of best fit, shown by the estimates. The <em>intercept</em> of the
line is in the first row, and the <em>slope</em> labelled by the
predictor variable. The other columns in the sub-table give the
uncertainty in the parameters (Std.Error), and the null hypothesis
p-value (<code>Pr(&gt;|t|)</code>) based on a t-statistic for each
parameter (against H<sub>0</sub> that there is no effect of a predictor,
<em>i.e</em>. the slope = 0)</li>
<li><code>Signif. codes</code>: just explains the asterisks *** or ** or
*</li>
<li>The last block of text contains information on how well the model
fits the data. We will focus on the R<sup>2</sup> (R-squared) value,
which is equivalent to the proportion of variance in the dependent
variable (<code>Cr</code> in this example) which is explained by the
predictor (<code>Al</code> in this example). We should also note the
overall <strong>p-value</strong>, based on the variance ratio
F-statistic, which tests H<sub>0</sub> = no effect of any
predictor.</li>
</ol>
<p>
 
</p>
<div style="border: 2px solid #039; padding: 8px;">
<h2 id="assumptions">
Requirements and Assumptions of [linear] regression
</h2>
<p>Ideally, any regression model that we create should fulfil certain
assumptions. There are four main assumptions based on the
<strong>residuals</strong> of the regression model. The residuals are
the differences between the model and reality (<em>e.g</em>. for simple
linear regression, the residuals are the the vertical distances between
the line of best fit and the actual points).</p>
<div class="figure">
<img src="regression_files/figure-html/show-residuals-1.png" alt="Figure 2: Example of simple linear regression with residuals represented by vertical lines showing the deviations of observations from the regression model relationship. Data are from Ashfield Flats sediments 2019-2023, resticted to sample `Type == Other`." width="40%" />
<p class="caption">
Figure 2: Example of simple linear regression with residuals represented
by vertical lines showing the deviations of observations from the
regression model relationship. Data are from Ashfield Flats sediments
2019-2023, resticted to sample <code>Type == Other</code>.
</p>
</div>
<p>The assumptions of linear regression are:</p>
<ol style="list-style-type: decimal">
<li><strong>Linear relationship</strong>: There is a linear relationship
between the independent variable, x, and the dependent variable, y.</li>
<li><strong>Independence</strong>: The residuals are independent. In
particular, there is no correlation between consecutive residuals in
time series data (<em>i.e</em>. no <em>autocorrelation</em>).</li>
<li><strong>Homoscedasticity</strong>: The residuals have constant
variance at every level of x.</li>
<li><strong>Normality</strong>: The residuals of the model are normally
distributed.</li>
</ol>
<p>We can check these assumptions graphically using <em>diagnostic
plots</em> (see below), or using formal statistical tests, which we do
after the diagnostic plots.</p>
</div>
<p>
 
</p>
<div id="diagnostic-plots-for-simple-linear-regression-cr-al"
class="section level3">
<h3>Diagnostic plots for Simple linear regression, Cr ~ Al</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">1.5</span>,<span class="dv">1</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">plot</span>(lmCrAlsimple, <span class="at">col=</span><span class="st">&quot;#003087&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="regression_files/figure-html/diagnostic-plots-simple-1.png" alt="Figure 3: Regression diagnostic plots for Cr predicted from Al using a simple linear regression model without grouping" width="480" />
<p class="caption">
Figure 3: Regression diagnostic plots for Cr predicted from Al using a
simple linear regression model without grouping
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>The diagnostic plots (Figure 3) are a visual test of some of the
assumptions of linear regression models, which relate mainly to the
residuals. <br> [An alternative from the <code>car</code> package is
<code>influenceIndexPlot(yourModelName)</code>].</p>
<p>The <strong>top left</strong> and <strong>bottom left</strong> plots
in Figure 3 allow us to assess the assumption of
<em>homoscedasticity</em>, that is, the residuals should be of similar
absolute magnitude independent of the value of the dependent variable
(actual or predicted). The top left plot also helps us to decide if the
residuals are <em>independent</em>. In both the top left and bottom left
plots, residuals should appear randomly distributed with a
near-horizontal smoothed (<span style="color:#FF0000;">red</span>)
line.</p>
<p>The <strong>top right</strong> plot in Figure 3 is a Q-Q plot which
tests another assumption of regression; that the <em>residuals should be
normally distributed</em>. The points should lie along (or close to) the
theoretical (dotted) line.</p>
<p>Finally the <strong>bottom left</strong> plot in Figure 3 tests
whether any observations have an unusual influence on the regression
statistics (the assumption is that they <em>do not</em>).</p>
<h2 id="diagtests">
Formal statistical tests of regression assumptions
</h2>
<p>We can test all of the assumptions with formal statistical tests
using the <code>car</code> and <code>lmtest</code> <strong>R</strong>
packages.</p>
<p>We can use the Shapiro-Wilk test to check the assumption of
<em>normally distributed residuals</em> (H<sub>0</sub> is that the
residuals <em>are</em> normally distributed):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(lmCrAlsimple<span class="sc">$</span>residuals) <span class="co"># normality</span></span></code></pre></div>
<pre><code>##
##  Shapiro-Wilk normality test
##
## data:  lmCrAlsimple$residuals
## W = 0.96084, p-value = 8.146e-08</code></pre>
<p>The Breusch-Godfrey test is for residual autocorrelation;
H<sub>0</sub> is that residuals are not autocorrelated (<em>i.e</em>.
observations probably <em>independent</em>)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">require</span>(lmtest)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">bgtest</span>(lmCrAlsimple) <span class="co"># autocorrelation (independence)</span></span></code></pre></div>
<pre><code>##
##  Breusch-Godfrey test for serial correlation of order up to 1
##
## data:  lmCrAlsimple
## LM test = 73.543, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>The Breusch-Pagan test is for heteroscedasticity; H<sub>0</sub> is
that residuals are <em>homoscedastic</em> (<em>i.e</em>. variance
independent of value of variable).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">bptest</span>(lmCrAlsimple) <span class="co"># homoscedasticity</span></span></code></pre></div>
<pre><code>##
##  studentized Breusch-Pagan test
##
## data:  lmCrAlsimple
## BP = 0.11665, df = 1, p-value = 0.7327</code></pre>
<p>The Rainbow test is to test the assumption of <em>linearity</em>;
H<sub>0</sub> is that the relationship is linear.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">raintest</span>(lmCrAlsimple) <span class="co"># linearity</span></span></code></pre></div>
<pre><code>##
##  Rainbow test
##
## data:  lmCrAlsimple
## Rain = 0.54384, df1 = 168, df2 = 165, p-value = 1</code></pre>
<p>The <code>outlierTest()</code> function in the <code>car</code>
package implements the Bonferroni outlier test; H<sub>0</sub> is that
all residuals are from the same population (<em>i.e</em>. no outliers).
H<sub>0</sub> is tested with the <strong>Bonferroni</strong> (NOT
unadjusted) p-value. If no Bonferroni p-value is≤ 0.05, so we cannot
reject H<sub>0</sub>, the function outputs the largest residual(s).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">require</span>(car)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">outlierTest</span>(lmCrAlsimple) <span class="co"># influential observations (outliers)</span></span></code></pre></div>
<pre><code>##      rstudent unadjusted p-value Bonferroni p
## 177  5.832413         1.2965e-08   4.3433e-06
## 227 -4.451964         1.1636e-05   3.8981e-03
## 134  4.212634         3.2558e-05   1.0907e-02</code></pre>
<p>Another common measure of whether individual observations are
influential in the regression is <em>Cook's distance</em>. We often use
a rule-of-thumb that observations with a Cook's distance &gt;0.5 could
be considered influential.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">cooks.distance</span>(lmCrAlsimple)) <span class="co"># influential observations</span></span></code></pre></div>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.
## 0.0000000 0.0002053 0.0008548 0.0035295 0.0026661 0.1354693</code></pre>
<p>Even more detail can be obtained using the function
<code>influence.measures()</code>. This produces a lot of output, so we
show only part of it here.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>infl.lmCrAl <span class="ot">&lt;-</span> <span class="fu">influence.measures</span>(lmCrAlsimple)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">summary</span>(infl.lmCrAl) <span class="co"># influential observations</span></span></code></pre></div>
<pre><code>## Potentially influential observations of
##   lm(formula = Cr ~ Al, data = afs1923) :
##
##     dfb.1_ dfb.Al dffit   cov.r   cook.d hat
## 2    0.00   0.06   0.14    0.98_*  0.01   0.00
## 134  0.53  -0.48   0.53_*  0.92_*  0.14   0.02
## 137  0.04  -0.04   0.04    1.02_*  0.00   0.01
## 138 -0.07   0.00  -0.17    0.96_*  0.01   0.00
## 168 -0.03   0.02  -0.03    1.02_*  0.00   0.01
## 177  0.49  -0.40   0.51_*  0.83_*  0.12   0.01
## 222 -0.10   0.09  -0.10    1.02_*  0.01   0.02
## 223 -0.10   0.09  -0.10    1.02_*  0.01   0.02
## 226 -0.10   0.05  -0.14    0.97_*  0.01   0.00
## 227  0.04  -0.15  -0.28_*  0.90_*  0.04   0.00
## 245  0.33  -0.44  -0.47_*  0.97_*  0.11   0.02_*
## 247  0.18  -0.24  -0.27_*  1.00    0.04   0.02
## 267  0.15  -0.22  -0.25_*  0.99    0.03   0.01
## 290 -0.10   0.09  -0.10    1.02_*  0.00   0.02
## 291 -0.10   0.10  -0.10    1.02_*  0.01   0.02_*
## 296 -0.07   0.06  -0.07    1.02_*  0.00   0.02
## 320 -0.03   0.03  -0.03    1.02_*  0.00   0.02</code></pre>
<p>To summarise:</p>
<template id="12396ac6-7fe1-4cae-b4f7-2f917d779c23"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-24779f96{}.cl-246f1e48{font-family:'Arial';font-size:9pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-246f1e52{font-family:'Arial';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2472679c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:1pt;padding-top:1pt;padding-left:1pt;padding-right:1pt;line-height: 1;background-color:transparent;}.cl-2472679d{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:2pt;padding-right:2pt;line-height: 1;background-color:transparent;}.cl-247279e4{width:1.575in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-247279ee{width:3.15in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-247279f8{width:1.969in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-247279f9{width:1.575in;background-color:rgba(239, 239, 239, 1.00);vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-247279fa{width:3.15in;background-color:rgba(239, 239, 239, 1.00);vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24727a02{width:1.969in;background-color:rgba(239, 239, 239, 1.00);vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24727a03{width:1.575in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24727a0c{width:3.15in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24727a0d{width:1.969in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-246b5df8{font-family:'Arial';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}</style><table class='cl-24779f96'><caption style="margin:0pt;text-align:left;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:0pt;padding-bottom:6pt;padding-left:0pt;padding-right:0pt;line-height: 1;background-color:transparent;"><span class="cl-246b5df8">Table 1: Summary of regression diagnostic tests for a model predicting Cr from Al in sediments from Ashfield Flats Reserve, based on data from samples collected from 2019-2023.</span></caption><thead><tr style="overflow-wrap:break-word;"><td class="cl-247279e4"><p class="cl-2472679c"><span class="cl-246f1e48">Test</span></p></td><td class="cl-247279ee"><p class="cl-2472679c"><span class="cl-246f1e48">Assessing</span></p></td><td class="cl-247279f8"><p class="cl-2472679c"><span class="cl-246f1e48">Results</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-247279f9"><p class="cl-2472679d"><span class="cl-246f1e52">Shapiro-Wilk</span></p></td><td class="cl-247279fa"><p class="cl-2472679d"><span class="cl-246f1e52">Are residuals normally distributed?</span></p></td><td class="cl-24727a02"><p class="cl-2472679d"><span class="cl-246f1e52">No (qq-plot suggests long tails)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24727a03"><p class="cl-2472679d"><span class="cl-246f1e52">Breusch-Godfrey</span></p></td><td class="cl-24727a0c"><p class="cl-2472679d"><span class="cl-246f1e52">Are residuals independent?</span></p></td><td class="cl-24727a0d"><p class="cl-2472679d"><span class="cl-246f1e52">No, there is autocorrelation</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-247279f9"><p class="cl-2472679d"><span class="cl-246f1e52">Breusch-Pagan</span></p></td><td class="cl-247279fa"><p class="cl-2472679d"><span class="cl-246f1e52">Are residuals homoscedastic?</span></p></td><td class="cl-24727a02"><p class="cl-2472679d"><span class="cl-246f1e52">Yes (p&lt;0.05)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24727a03"><p class="cl-2472679d"><span class="cl-246f1e52">Rainbow</span></p></td><td class="cl-24727a0c"><p class="cl-2472679d"><span class="cl-246f1e52">Is the relationship linear?</span></p></td><td class="cl-24727a0d"><p class="cl-2472679d"><span class="cl-246f1e52">Yes (p&lt;0.05)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-247279f9"><p class="cl-2472679d"><span class="cl-246f1e52">Outlier</span></p></td><td class="cl-247279fa"><p class="cl-2472679d"><span class="cl-246f1e52">Are there significant outliers (Bonferroni)?</span></p></td><td class="cl-24727a02"><p class="cl-2472679d"><span class="cl-246f1e52">3 points are possible outliers</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24727a03"><p class="cl-2472679d"><span class="cl-246f1e52">Cook's Distance</span></p></td><td class="cl-24727a0c"><p class="cl-2472679d"><span class="cl-246f1e52">Are there any potentially influential observations?</span></p></td><td class="cl-24727a0d"><p class="cl-2472679d"><span class="cl-246f1e52">No (no values &gt; 0.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-247279f9"><p class="cl-2472679d"><span class="cl-246f1e52">Infuence Measures</span></p></td><td class="cl-247279fa"><p class="cl-2472679d"><span class="cl-246f1e52">Are there any potentially influential observations?</span></p></td><td class="cl-24727a02"><p class="cl-2472679d"><span class="cl-246f1e52">Yes (17 out of 335 observations)</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="99d9128a-b415-40b0-bd1e-2388a53b846c"></div>
<script>
var dest = document.getElementById("99d9128a-b415-40b0-bd1e-2388a53b846c");
var template = document.getElementById("12396ac6-7fe1-4cae-b4f7-2f917d779c23");
var caption = template.content.querySelector("caption");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>
 
</p>
<p>The summary of the diagnostic tests in Table 1 shows that not all the
formal assumptions of regression are fulfilled by our model. While this
means the model may not be perfectly valid from a statistical
perspective, we also recall that the regression output showed that
nearly 80% of the variance in Cr could be explained by Al. So, from a
practical perspective, our simple regression model could still be used
for prediction.</p>
<p>We can show the regression model relationship with two types of
interval: a <em>confidence interval</em>, and a <em>prediction
interval</em>:</p>
<div class="figure">
<img src="regression_files/figure-html/lm-conf-pred-intervals-1.png" alt="Figure 4: Simple linear regression relationship bewteen Cr and Al, showing 95% confidence and prediction intervals. Data are from Ashfield Flats sediments 2019-2023." width="384" />
<p class="caption">
Figure 4: Simple linear regression relationship bewteen Cr and Al,
showing 95% confidence and prediction intervals. Data are from Ashfield
Flats sediments 2019-2023.
</p>
</div>
<p>
 
</p>
<p>The intervals in Figure 4 are noticeably different, with the
confidence interval much narrower than the comparable prediction
interval. The key differences are that:</p>
<ul>
<li>the <strong>confidence interval</strong> shows the range of
<em>mean</em> Cr for any given value of Al that would be expected 95% of
the time</li>
<li>the <strong>prediction interval</strong> shows the range of Cr
values that <em>a single additional sample</em> could take, for
different values of Al</li>
</ul>
<p>The prediction interval, then, is the one we need to consider when
predicting an unknown concentration of Cr from a known concentration of
Al in sediment. In this example, with R<sup>2</sup> nearly 0.8, we may
not have expected such a large prediction uncertainty – but it's good to
be aware of the practical limitations of regression modelling.</p>
<p>A very practical application of regression prediction is when using
<strong>calibration curves</strong> in different types of sample
analysis. The plots in Figure 5 show why your lab instructor nags you to
take care with your measurements when preparing standards and samples,
and demands that your calibration has R² close to 0.9999!</p>
<div class="figure">
<p><img src="./images/FRP_calib.png"
alt="Figure 5: Calibration curves for filterable reactive phosphate of different quality and having different R² values. The dotted lines show interpolation of the calibration lines at Absorbance = 0.29, and the resulting range of prediction intervals." /></p>
<p class="caption">
Figure 5: Calibration curves for filterable reactive phosphate of
different quality and having different R² values. The dotted lines show
interpolation of the calibration lines at Absorbance = 0.29, and the
resulting range of prediction intervals.
</p>
</div>
<p>
 
</p>
<div
style="border: 2px solid #039; background-color:#e8e8e8; padding: 8px;">
<p>Subsequent sessions will cover grouped and multiple regression. These
methods may make prediction more accurate by:</p>
<ol style="list-style-type: lower-roman">
<li>allowing regression relationships to differ for different groups in
our data (defined by a factor variable) – <em>regression by groups</em>,
or</li>
<li>testing a model which has more than one predictor variable for our
dependent variable – <em>multiple regression</em>.</li>
</ol>
</div>
<p>
 
</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Fox, J. and Weisberg, S. (2019). <em>An</em> <code>R</code>
<em>Companion to Applied Regression, Third Edition</em>. Thousand Oaks
CA: Sage. <a
href="https://socialsciences.mcmaster.ca/jfox/Books/Companion/"
target="_blank">https://socialsciences.mcmaster.ca/jfox/Books/Companion/</a>
(<strong>R</strong> packages <code>car</code> and
<code>effects</code>)</p>
<p>Garnier S, Ross N, Rudis R, Camargo AP, Sciaini M, Scherer C (2021).
<em>Rvision – Colorblind-Friendly Color Maps for R</em>. R package
version 0.6.2. (<strong>R</strong> package <code>viridis</code>)</p>
<p>Reimann, C., Filzmoser, P., Garrett, R.G., Dutter, R., (2008).
<em>Statistical Data Analysis Explained: Applied Environmental
Statistics with R</em>. John Wiley &amp; Sons, Chichester, England (see
Chapter 16).</p>
<p>Zeileis, A. and Hothorn, T. (2002). Diagnostic Checking in Regression
Relationships. <em>R News</em> <strong>2</strong>(3), 7-10. <a
href="https://CRAN.R-project.org/doc/Rnews/"
target="_blank">https://CRAN.R-project.org/doc/Rnews/</a>
(<strong>R</strong> package <code>lmtest</code>)</p>
<p>
 
</p>
</div>

<!DOCTYPE html>

<html>
<body>
<hr style="height: 2px; background-color: #003087;" />
<p><span style="font-size:10pt"><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><strong>CC-BY-SA</strong></a> • All content by <a href="https://github.com/Ratey-AtUWA" target="_blank">Ratey-AtUWA</a>. My <a href="https://www.uwa.edu.au/schools/agriculture-and-environment" target="_blank">employer</a> does not necessarily know about or endorse the content of this website.</span><br>
<span style="font-size:9pt">Created with <a href="https://bookdown.org/yihui/rmarkdown/" target="_blank"><span style="font-family: monospace;">rmarkdown</span></a> in <a href="https://posit.co/download/rstudio-desktop/" target="_blank"><span class="fa fa-registered"></span> RStudio</a>.</span></p>
</body>
</html>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
